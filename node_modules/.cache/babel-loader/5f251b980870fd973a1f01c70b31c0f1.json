{"ast":null,"code":"'use strict';\n\nfunction Kareem() {\n  this._pres = new Map();\n  this._posts = new Map();\n}\n\nKareem.prototype.execPre = function (name, context, args, callback) {\n  if (arguments.length === 3) {\n    callback = args;\n    args = [];\n  }\n\n  var pres = this._pres.get(name) || [];\n  var numPres = pres.length;\n  var numAsyncPres = pres.numAsync || 0;\n  var currentPre = 0;\n  var asyncPresLeft = numAsyncPres;\n  var done = false;\n  var $args = args;\n\n  if (!numPres) {\n    return nextTick(function () {\n      callback(null);\n    });\n  }\n\n  var next = function () {\n    if (currentPre >= numPres) {\n      return;\n    }\n\n    var pre = pres[currentPre];\n\n    if (pre.isAsync) {\n      var args = [decorateNextFn(_next), decorateNextFn(function (error) {\n        if (error) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          return callback(error);\n        }\n\n        if (--asyncPresLeft === 0 && currentPre >= numPres) {\n          return callback(null);\n        }\n      })];\n      callMiddlewareFunction(pre.fn, context, args, args[0]);\n    } else if (pre.fn.length > 0) {\n      var args = [decorateNextFn(_next)];\n\n      var _args = arguments.length >= 2 ? arguments : [null].concat($args);\n\n      for (var i = 1; i < _args.length; ++i) {\n        args.push(_args[i]);\n      }\n\n      callMiddlewareFunction(pre.fn, context, args, args[0]);\n    } else {\n      let maybePromiseLike = null;\n\n      try {\n        maybePromiseLike = pre.fn.call(context);\n      } catch (err) {\n        if (err != null) {\n          return callback(err);\n        }\n      }\n\n      if (isPromiseLike(maybePromiseLike)) {\n        maybePromiseLike.then(() => _next(), err => _next(err));\n      } else {\n        if (++currentPre >= numPres) {\n          if (asyncPresLeft > 0) {\n            // Leave parallel hooks to run\n            return;\n          } else {\n            return nextTick(function () {\n              callback(null);\n            });\n          }\n        }\n\n        next();\n      }\n    }\n  };\n\n  next.apply(null, [null].concat(args));\n\n  function _next(error) {\n    if (error) {\n      if (done) {\n        return;\n      }\n\n      done = true;\n      return callback(error);\n    }\n\n    if (++currentPre >= numPres) {\n      if (asyncPresLeft > 0) {\n        // Leave parallel hooks to run\n        return;\n      } else {\n        return callback(null);\n      }\n    }\n\n    next.apply(context, arguments);\n  }\n};\n\nKareem.prototype.execPreSync = function (name, context, args) {\n  var pres = this._pres.get(name) || [];\n  var numPres = pres.length;\n\n  for (var i = 0; i < numPres; ++i) {\n    pres[i].fn.apply(context, args || []);\n  }\n};\n\nKareem.prototype.execPost = function (name, context, args, options, callback) {\n  if (arguments.length < 5) {\n    callback = options;\n    options = null;\n  }\n\n  var posts = this._posts.get(name) || [];\n  var numPosts = posts.length;\n  var currentPost = 0;\n  var firstError = null;\n\n  if (options && options.error) {\n    firstError = options.error;\n  }\n\n  if (!numPosts) {\n    return nextTick(function () {\n      callback.apply(null, [firstError].concat(args));\n    });\n  }\n\n  var next = function () {\n    var post = posts[currentPost].fn;\n    var numArgs = 0;\n    var argLength = args.length;\n    var newArgs = [];\n\n    for (var i = 0; i < argLength; ++i) {\n      numArgs += args[i] && args[i]._kareemIgnore ? 0 : 1;\n\n      if (!args[i] || !args[i]._kareemIgnore) {\n        newArgs.push(args[i]);\n      }\n    }\n\n    if (firstError) {\n      if (post.length === numArgs + 2) {\n        const _cb = decorateNextFn(function (error) {\n          if (error) {\n            firstError = error;\n          }\n\n          if (++currentPost >= numPosts) {\n            return callback.call(null, firstError);\n          }\n\n          next();\n        });\n\n        callMiddlewareFunction(post, context, [firstError].concat(newArgs).concat([_cb]), _cb);\n      } else {\n        if (++currentPost >= numPosts) {\n          return callback.call(null, firstError);\n        }\n\n        next();\n      }\n    } else {\n      const _cb = decorateNextFn(function (error) {\n        if (error) {\n          firstError = error;\n          return next();\n        }\n\n        if (++currentPost >= numPosts) {\n          return callback.apply(null, [null].concat(args));\n        }\n\n        next();\n      });\n\n      if (post.length === numArgs + 2) {\n        // Skip error handlers if no error\n        if (++currentPost >= numPosts) {\n          return callback.apply(null, [null].concat(args));\n        }\n\n        return next();\n      }\n\n      if (post.length === numArgs + 1) {\n        callMiddlewareFunction(post, context, newArgs.concat([_cb]), _cb);\n      } else {\n        let error;\n        let maybePromiseLike;\n\n        try {\n          maybePromiseLike = post.apply(context, newArgs);\n        } catch (err) {\n          error = err;\n          firstError = err;\n        }\n\n        if (isPromiseLike(maybePromiseLike)) {\n          return maybePromiseLike.then(() => _cb(), err => _cb(err));\n        }\n\n        if (++currentPost >= numPosts) {\n          return callback.apply(null, [error].concat(args));\n        }\n\n        next();\n      }\n    }\n  };\n\n  next();\n};\n\nKareem.prototype.execPostSync = function (name, context, args) {\n  const posts = this._posts.get(name) || [];\n  const numPosts = posts.length;\n\n  for (let i = 0; i < numPosts; ++i) {\n    posts[i].fn.apply(context, args || []);\n  }\n};\n\nKareem.prototype.createWrapperSync = function (name, fn) {\n  var kareem = this;\n  return function syncWrapper() {\n    kareem.execPreSync(name, this, arguments);\n    var toReturn = fn.apply(this, arguments);\n    kareem.execPostSync(name, this, [toReturn]);\n    return toReturn;\n  };\n};\n\nfunction _handleWrapError(instance, error, name, context, args, options, callback) {\n  if (options.useErrorHandlers) {\n    return instance.execPost(name, context, args, {\n      error: error\n    }, function (error) {\n      return typeof callback === 'function' && callback(error);\n    });\n  } else {\n    return typeof callback === 'function' && callback(error);\n  }\n}\n\nKareem.prototype.wrap = function (name, fn, context, args, options) {\n  const lastArg = args.length > 0 ? args[args.length - 1] : null;\n  const argsWithoutCb = Array.from(args);\n  typeof lastArg === 'function' && argsWithoutCb.pop();\n\n  const _this = this;\n\n  options = options || {};\n  const checkForPromise = options.checkForPromise;\n  this.execPre(name, context, args, function (error) {\n    if (error) {\n      const numCallbackParams = options.numCallbackParams || 0;\n      const errorArgs = options.contextParameter ? [context] : [];\n\n      for (var i = errorArgs.length; i < numCallbackParams; ++i) {\n        errorArgs.push(null);\n      }\n\n      return _handleWrapError(_this, error, name, context, errorArgs, options, lastArg);\n    }\n\n    const numParameters = fn.length;\n    let ret;\n\n    try {\n      ret = fn.apply(context, argsWithoutCb.concat(_cb));\n    } catch (err) {\n      return _cb(err);\n    }\n\n    if (checkForPromise) {\n      if (isPromiseLike(ret)) {\n        // Thenable, use it\n        return ret.then(res => _cb(null, res), err => _cb(err));\n      } // If `fn()` doesn't have a callback argument and doesn't return a\n      // promise, assume it is sync\n\n\n      if (numParameters < argsWithoutCb.length + 1) {\n        return _cb(null, ret);\n      }\n    }\n\n    function _cb() {\n      const argsWithoutError = Array.from(arguments);\n      argsWithoutError.shift();\n\n      if (options.nullResultByDefault && argsWithoutError.length === 0) {\n        argsWithoutError.push(null);\n      }\n\n      if (arguments[0]) {\n        // Assume error\n        return _handleWrapError(_this, arguments[0], name, context, argsWithoutError, options, lastArg);\n      } else {\n        _this.execPost(name, context, argsWithoutError, function () {\n          if (lastArg === null) {\n            return;\n          }\n\n          arguments[0] ? lastArg(arguments[0]) : lastArg.apply(context, arguments);\n        });\n      }\n    }\n  });\n};\n\nKareem.prototype.filter = function (fn) {\n  const clone = this.clone();\n  const pres = Array.from(clone._pres.keys());\n\n  for (const name of pres) {\n    const hooks = this._pres.get(name).map(h => Object.assign({}, h, {\n      name: name\n    })).filter(fn);\n\n    if (hooks.length === 0) {\n      clone._pres.delete(name);\n\n      continue;\n    }\n\n    hooks.numAsync = hooks.filter(h => h.isAsync).length;\n\n    clone._pres.set(name, hooks);\n  }\n\n  const posts = Array.from(clone._posts.keys());\n\n  for (const name of posts) {\n    const hooks = this._posts.get(name).map(h => Object.assign({}, h, {\n      name: name\n    })).filter(fn);\n\n    if (hooks.length === 0) {\n      clone._posts.delete(name);\n\n      continue;\n    }\n\n    clone._posts.set(name, hooks);\n  }\n\n  return clone;\n};\n\nKareem.prototype.hasHooks = function (name) {\n  return this._pres.has(name) || this._posts.has(name);\n};\n\nKareem.prototype.createWrapper = function (name, fn, context, options) {\n  var _this = this;\n\n  if (!this.hasHooks(name)) {\n    // Fast path: if there's no hooks for this function, just return the\n    // function wrapped in a nextTick()\n    return function () {\n      nextTick(() => fn.apply(this, arguments));\n    };\n  }\n\n  return function () {\n    var _context = context || this;\n\n    _this.wrap(name, fn, _context, Array.from(arguments), options);\n  };\n};\n\nKareem.prototype.pre = function (name, isAsync, fn, error, unshift) {\n  let options = {};\n\n  if (typeof isAsync === 'object' && isAsync !== null) {\n    options = isAsync;\n    isAsync = options.isAsync;\n  } else if (typeof arguments[1] !== 'boolean') {\n    fn = isAsync;\n    isAsync = false;\n  }\n\n  const pres = this._pres.get(name) || [];\n\n  this._pres.set(name, pres);\n\n  if (isAsync) {\n    pres.numAsync = pres.numAsync || 0;\n    ++pres.numAsync;\n  }\n\n  if (typeof fn !== 'function') {\n    throw new Error('pre() requires a function, got \"' + typeof fn + '\"');\n  }\n\n  if (unshift) {\n    pres.unshift(Object.assign({}, options, {\n      fn: fn,\n      isAsync: isAsync\n    }));\n  } else {\n    pres.push(Object.assign({}, options, {\n      fn: fn,\n      isAsync: isAsync\n    }));\n  }\n\n  return this;\n};\n\nKareem.prototype.post = function (name, options, fn, unshift) {\n  const hooks = this._posts.get(name) || [];\n\n  if (typeof options === 'function') {\n    unshift = !!fn;\n    fn = options;\n    options = {};\n  }\n\n  if (typeof fn !== 'function') {\n    throw new Error('post() requires a function, got \"' + typeof fn + '\"');\n  }\n\n  if (unshift) {\n    hooks.unshift(Object.assign({}, options, {\n      fn: fn\n    }));\n  } else {\n    hooks.push(Object.assign({}, options, {\n      fn: fn\n    }));\n  }\n\n  this._posts.set(name, hooks);\n\n  return this;\n};\n\nKareem.prototype.clone = function () {\n  const n = new Kareem();\n\n  for (let key of this._pres.keys()) {\n    const clone = this._pres.get(key).slice();\n\n    clone.numAsync = this._pres.get(key).numAsync;\n\n    n._pres.set(key, clone);\n  }\n\n  for (let key of this._posts.keys()) {\n    n._posts.set(key, this._posts.get(key).slice());\n  }\n\n  return n;\n};\n\nKareem.prototype.merge = function (other, clone) {\n  clone = arguments.length === 1 ? true : clone;\n  var ret = clone ? this.clone() : this;\n\n  for (let key of other._pres.keys()) {\n    const sourcePres = ret._pres.get(key) || [];\n\n    const deduplicated = other._pres.get(key). // Deduplicate based on `fn`\n    filter(p => sourcePres.map(_p => _p.fn).indexOf(p.fn) === -1);\n\n    const combined = sourcePres.concat(deduplicated);\n    combined.numAsync = sourcePres.numAsync || 0;\n    combined.numAsync += deduplicated.filter(p => p.isAsync).length;\n\n    ret._pres.set(key, combined);\n  }\n\n  for (let key of other._posts.keys()) {\n    const sourcePosts = ret._posts.get(key) || [];\n\n    const deduplicated = other._posts.get(key).filter(p => sourcePosts.indexOf(p) === -1);\n\n    ret._posts.set(key, sourcePosts.concat(deduplicated));\n  }\n\n  return ret;\n};\n\nfunction callMiddlewareFunction(fn, context, args, next) {\n  let maybePromiseLike;\n\n  try {\n    maybePromiseLike = fn.apply(context, args);\n  } catch (error) {\n    return next(error);\n  }\n\n  if (isPromiseLike(maybePromiseLike)) {\n    maybePromiseLike.then(() => next(), err => next(err));\n  }\n}\n\nfunction isPromiseLike(v) {\n  return typeof v === 'object' && v !== null && typeof v.then === 'function';\n}\n\nfunction decorateNextFn(fn) {\n  var called = false;\n\n  var _this = this;\n\n  return function () {\n    // Ensure this function can only be called once\n    if (called) {\n      return;\n    }\n\n    called = true; // Make sure to clear the stack so try/catch doesn't catch errors\n    // in subsequent middleware\n\n    return nextTick(() => fn.apply(_this, arguments));\n  };\n}\n\nconst nextTick = typeof process === 'object' && process !== null && process.nextTick || function nextTick(cb) {\n  setTimeout(cb, 0);\n};\n\nmodule.exports = Kareem;","map":{"version":3,"names":["Kareem","_pres","Map","_posts","prototype","execPre","name","context","args","callback","arguments","length","pres","get","numPres","numAsyncPres","numAsync","currentPre","asyncPresLeft","done","$args","nextTick","next","pre","isAsync","decorateNextFn","_next","error","callMiddlewareFunction","fn","_args","concat","i","push","maybePromiseLike","call","err","isPromiseLike","then","apply","execPreSync","execPost","options","posts","numPosts","currentPost","firstError","post","numArgs","argLength","newArgs","_kareemIgnore","_cb","execPostSync","createWrapperSync","kareem","syncWrapper","toReturn","_handleWrapError","instance","useErrorHandlers","wrap","lastArg","argsWithoutCb","Array","from","pop","_this","checkForPromise","numCallbackParams","errorArgs","contextParameter","numParameters","ret","res","argsWithoutError","shift","nullResultByDefault","filter","clone","keys","hooks","map","h","Object","assign","delete","set","hasHooks","has","createWrapper","_context","unshift","Error","n","key","slice","merge","other","sourcePres","deduplicated","p","_p","indexOf","combined","sourcePosts","v","called","process","cb","setTimeout","module","exports"],"sources":["B:/web_project_react/web_car_react/node_modules/kareem/index.js"],"sourcesContent":["'use strict';\n\nfunction Kareem() {\n  this._pres = new Map();\n  this._posts = new Map();\n}\n\nKareem.prototype.execPre = function(name, context, args, callback) {\n  if (arguments.length === 3) {\n    callback = args;\n    args = [];\n  }\n  var pres = this._pres.get(name) || [];\n  var numPres = pres.length;\n  var numAsyncPres = pres.numAsync || 0;\n  var currentPre = 0;\n  var asyncPresLeft = numAsyncPres;\n  var done = false;\n  var $args = args;\n\n  if (!numPres) {\n    return nextTick(function() {\n      callback(null);\n    });\n  }\n\n  var next = function() {\n    if (currentPre >= numPres) {\n      return;\n    }\n    var pre = pres[currentPre];\n\n    if (pre.isAsync) {\n      var args = [\n        decorateNextFn(_next),\n        decorateNextFn(function(error) {\n          if (error) {\n            if (done) {\n              return;\n            }\n            done = true;\n            return callback(error);\n          }\n          if (--asyncPresLeft === 0 && currentPre >= numPres) {\n            return callback(null);\n          }\n        })\n      ];\n\n      callMiddlewareFunction(pre.fn, context, args, args[0]);\n    } else if (pre.fn.length > 0) {\n      var args = [decorateNextFn(_next)];\n      var _args = arguments.length >= 2 ? arguments : [null].concat($args);\n      for (var i = 1; i < _args.length; ++i) {\n        args.push(_args[i]);\n      }\n\n      callMiddlewareFunction(pre.fn, context, args, args[0]);\n    } else {\n      let maybePromiseLike = null;\n      try {\n        maybePromiseLike = pre.fn.call(context);\n      } catch (err) {\n        if (err != null) {\n          return callback(err);\n        }\n      }\n\n      if (isPromiseLike(maybePromiseLike)) {\n        maybePromiseLike.then(() => _next(), err => _next(err));\n      } else {\n        if (++currentPre >= numPres) {\n          if (asyncPresLeft > 0) {\n            // Leave parallel hooks to run\n            return;\n          } else {\n            return nextTick(function() {\n              callback(null);\n            });\n          }\n        }\n        next();\n      }\n    }\n  };\n\n  next.apply(null, [null].concat(args));\n\n  function _next(error) {\n    if (error) {\n      if (done) {\n        return;\n      }\n      done = true;\n      return callback(error);\n    }\n\n    if (++currentPre >= numPres) {\n      if (asyncPresLeft > 0) {\n        // Leave parallel hooks to run\n        return;\n      } else {\n        return callback(null);\n      }\n    }\n\n    next.apply(context, arguments);\n  }\n};\n\nKareem.prototype.execPreSync = function(name, context, args) {\n  var pres = this._pres.get(name) || [];\n  var numPres = pres.length;\n\n  for (var i = 0; i < numPres; ++i) {\n    pres[i].fn.apply(context, args || []);\n  }\n};\n\nKareem.prototype.execPost = function(name, context, args, options, callback) {\n  if (arguments.length < 5) {\n    callback = options;\n    options = null;\n  }\n  var posts = this._posts.get(name) || [];\n  var numPosts = posts.length;\n  var currentPost = 0;\n\n  var firstError = null;\n  if (options && options.error) {\n    firstError = options.error;\n  }\n\n  if (!numPosts) {\n    return nextTick(function() {\n      callback.apply(null, [firstError].concat(args));\n    });\n  }\n\n  var next = function() {\n    var post = posts[currentPost].fn;\n    var numArgs = 0;\n    var argLength = args.length;\n    var newArgs = [];\n    for (var i = 0; i < argLength; ++i) {\n      numArgs += args[i] && args[i]._kareemIgnore ? 0 : 1;\n      if (!args[i] || !args[i]._kareemIgnore) {\n        newArgs.push(args[i]);\n      }\n    }\n\n    if (firstError) {\n      if (post.length === numArgs + 2) {\n        const _cb = decorateNextFn(function(error) {\n          if (error) {\n            firstError = error;\n          }\n          if (++currentPost >= numPosts) {\n            return callback.call(null, firstError);\n          }\n          next();\n        });\n\n        callMiddlewareFunction(post, context,\n          [firstError].concat(newArgs).concat([_cb]), _cb);\n      } else {\n        if (++currentPost >= numPosts) {\n          return callback.call(null, firstError);\n        }\n        next();\n      }\n    } else {\n      const _cb = decorateNextFn(function(error) {\n        if (error) {\n          firstError = error;\n          return next();\n        }\n\n        if (++currentPost >= numPosts) {\n          return callback.apply(null, [null].concat(args));\n        }\n\n        next();\n      });\n\n      if (post.length === numArgs + 2) {\n        // Skip error handlers if no error\n        if (++currentPost >= numPosts) {\n          return callback.apply(null, [null].concat(args));\n        }\n        return next();\n      }\n      if (post.length === numArgs + 1) {\n        callMiddlewareFunction(post, context, newArgs.concat([_cb]), _cb);\n      } else {\n        let error;\n        let maybePromiseLike;\n        try {\n          maybePromiseLike = post.apply(context, newArgs);\n        } catch (err) {\n          error = err;\n          firstError = err;\n        }\n\n        if (isPromiseLike(maybePromiseLike)) {\n          return maybePromiseLike.then(() => _cb(), err => _cb(err));\n        }\n\n        if (++currentPost >= numPosts) {\n          return callback.apply(null, [error].concat(args));\n        }\n\n        next();\n      }\n    }\n  };\n\n  next();\n};\n\nKareem.prototype.execPostSync = function(name, context, args) {\n  const posts = this._posts.get(name) || [];\n  const numPosts = posts.length;\n\n  for (let i = 0; i < numPosts; ++i) {\n    posts[i].fn.apply(context, args || []);\n  }\n};\n\nKareem.prototype.createWrapperSync = function(name, fn) {\n  var kareem = this;\n  return function syncWrapper() {\n    kareem.execPreSync(name, this, arguments);\n\n    var toReturn = fn.apply(this, arguments);\n\n    kareem.execPostSync(name, this, [toReturn]);\n\n    return toReturn;\n  };\n}\n\nfunction _handleWrapError(instance, error, name, context, args, options, callback) {\n  if (options.useErrorHandlers) {\n    return instance.execPost(name, context, args, { error: error }, function(error) {\n      return typeof callback === 'function' && callback(error);\n    });\n  } else {\n    return typeof callback === 'function' && callback(error);\n  }\n}\n\nKareem.prototype.wrap = function(name, fn, context, args, options) {\n  const lastArg = (args.length > 0 ? args[args.length - 1] : null);\n  const argsWithoutCb = Array.from(args);\n  typeof lastArg === 'function' && argsWithoutCb.pop();\n  const _this = this;\n\n  options = options || {};\n  const checkForPromise = options.checkForPromise;\n\n  this.execPre(name, context, args, function(error) {\n    if (error) {\n      const numCallbackParams = options.numCallbackParams || 0;\n      const errorArgs = options.contextParameter ? [context] : [];\n      for (var i = errorArgs.length; i < numCallbackParams; ++i) {\n        errorArgs.push(null);\n      }\n      return _handleWrapError(_this, error, name, context, errorArgs,\n        options, lastArg);\n    }\n\n    const numParameters = fn.length;\n    let ret;\n    try {\n      ret = fn.apply(context, argsWithoutCb.concat(_cb));\n    } catch (err) {\n      return _cb(err);\n    }\n\n    if (checkForPromise) {\n      if (isPromiseLike(ret)) {\n        // Thenable, use it\n        return ret.then(\n          res => _cb(null, res),\n          err => _cb(err)\n        );\n      }\n\n      // If `fn()` doesn't have a callback argument and doesn't return a\n      // promise, assume it is sync\n      if (numParameters < argsWithoutCb.length + 1) {\n        return _cb(null, ret);\n      }\n    }\n\n    function _cb() {\n      const argsWithoutError = Array.from(arguments);\n      argsWithoutError.shift();\n      if (options.nullResultByDefault && argsWithoutError.length === 0) {\n        argsWithoutError.push(null);\n      }\n      if (arguments[0]) {\n        // Assume error\n        return _handleWrapError(_this, arguments[0], name, context,\n          argsWithoutError, options, lastArg);\n      } else {\n        _this.execPost(name, context, argsWithoutError, function() {\n          if (lastArg === null) {\n            return;\n          }\n          arguments[0]\n            ? lastArg(arguments[0])\n            : lastArg.apply(context, arguments)\n        });\n      }\n    }\n  });\n};\n\nKareem.prototype.filter = function(fn) {\n  const clone = this.clone();\n\n  const pres = Array.from(clone._pres.keys());\n  for (const name of pres) {\n    const hooks = this._pres.get(name).\n      map(h => Object.assign({}, h, { name: name })).\n      filter(fn);\n\n    if (hooks.length === 0) {\n      clone._pres.delete(name);\n      continue;\n    }\n\n    hooks.numAsync = hooks.filter(h => h.isAsync).length;\n\n    clone._pres.set(name, hooks);\n  }\n\n  const posts = Array.from(clone._posts.keys());\n  for (const name of posts) {\n    const hooks = this._posts.get(name).\n      map(h => Object.assign({}, h, { name: name })).\n      filter(fn);\n\n    if (hooks.length === 0) {\n      clone._posts.delete(name);\n      continue;\n    }\n\n    clone._posts.set(name, hooks);\n  }\n\n  return clone;\n};\n\nKareem.prototype.hasHooks = function(name) {\n  return this._pres.has(name) || this._posts.has(name);\n};\n\nKareem.prototype.createWrapper = function(name, fn, context, options) {\n  var _this = this;\n  if (!this.hasHooks(name)) {\n    // Fast path: if there's no hooks for this function, just return the\n    // function wrapped in a nextTick()\n    return function() {\n      nextTick(() => fn.apply(this, arguments));\n    };\n  }\n  return function() {\n    var _context = context || this;\n    _this.wrap(name, fn, _context, Array.from(arguments), options);\n  };\n};\n\nKareem.prototype.pre = function(name, isAsync, fn, error, unshift) {\n  let options = {};\n  if (typeof isAsync === 'object' && isAsync !== null) {\n    options = isAsync;\n    isAsync = options.isAsync;\n  } else if (typeof arguments[1] !== 'boolean') {\n    fn = isAsync;\n    isAsync = false;\n  }\n\n  const pres = this._pres.get(name) || [];\n  this._pres.set(name, pres);\n\n  if (isAsync) {\n    pres.numAsync = pres.numAsync || 0;\n    ++pres.numAsync;\n  }\n\n  if (typeof fn !== 'function') {\n    throw new Error('pre() requires a function, got \"' + typeof fn + '\"');\n  }\n\n  if (unshift) {\n    pres.unshift(Object.assign({}, options, { fn: fn, isAsync: isAsync }));\n  } else {\n    pres.push(Object.assign({}, options, { fn: fn, isAsync: isAsync }));\n  }\n\n  return this;\n};\n\nKareem.prototype.post = function(name, options, fn, unshift) {\n  const hooks = this._posts.get(name) || [];\n\n  if (typeof options === 'function') {\n    unshift = !!fn;\n    fn = options;\n    options = {};\n  }\n\n  if (typeof fn !== 'function') {\n    throw new Error('post() requires a function, got \"' + typeof fn + '\"');\n  }\n\n  if (unshift) {\n    hooks.unshift(Object.assign({}, options, { fn: fn }));\n  } else {\n    hooks.push(Object.assign({}, options, { fn: fn }));\n  }\n  this._posts.set(name, hooks);\n  return this;\n};\n\nKareem.prototype.clone = function() {\n  const n = new Kareem();\n\n  for (let key of this._pres.keys()) {\n    const clone = this._pres.get(key).slice();\n    clone.numAsync = this._pres.get(key).numAsync;\n    n._pres.set(key, clone);\n  }\n  for (let key of this._posts.keys()) {\n    n._posts.set(key, this._posts.get(key).slice());\n  }\n\n  return n;\n};\n\nKareem.prototype.merge = function(other, clone) {\n  clone = arguments.length === 1 ? true : clone;\n  var ret = clone ? this.clone() : this;\n\n  for (let key of other._pres.keys()) {\n    const sourcePres = ret._pres.get(key) || [];\n    const deduplicated = other._pres.get(key).\n      // Deduplicate based on `fn`\n      filter(p => sourcePres.map(_p => _p.fn).indexOf(p.fn) === -1);\n    const combined = sourcePres.concat(deduplicated);\n    combined.numAsync = sourcePres.numAsync || 0;\n    combined.numAsync += deduplicated.filter(p => p.isAsync).length;\n    ret._pres.set(key, combined);\n  }\n  for (let key of other._posts.keys()) {\n    const sourcePosts = ret._posts.get(key) || [];\n    const deduplicated = other._posts.get(key).\n      filter(p => sourcePosts.indexOf(p) === -1);\n    ret._posts.set(key, sourcePosts.concat(deduplicated));\n  }\n\n  return ret;\n};\n\nfunction callMiddlewareFunction(fn, context, args, next) {\n  let maybePromiseLike;\n  try {\n    maybePromiseLike = fn.apply(context, args);\n  } catch (error) {\n    return next(error);\n  }\n\n  if (isPromiseLike(maybePromiseLike)) {\n    maybePromiseLike.then(() => next(), err => next(err));\n  }\n}\n\nfunction isPromiseLike(v) {\n  return (typeof v === 'object' && v !== null && typeof v.then === 'function');\n}\n\nfunction decorateNextFn(fn) {\n  var called = false;\n  var _this = this;\n  return function() {\n    // Ensure this function can only be called once\n    if (called) {\n      return;\n    }\n    called = true;\n    // Make sure to clear the stack so try/catch doesn't catch errors\n    // in subsequent middleware\n    return nextTick(() => fn.apply(_this, arguments));\n  };\n}\n\nconst nextTick = typeof process === 'object' && process !== null && process.nextTick || function nextTick(cb) { \n  setTimeout(cb, 0); \n}\n\nmodule.exports = Kareem;\n"],"mappings":"AAAA;;AAEA,SAASA,MAAT,GAAkB;EAChB,KAAKC,KAAL,GAAa,IAAIC,GAAJ,EAAb;EACA,KAAKC,MAAL,GAAc,IAAID,GAAJ,EAAd;AACD;;AAEDF,MAAM,CAACI,SAAP,CAAiBC,OAAjB,GAA2B,UAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,EAA8BC,QAA9B,EAAwC;EACjE,IAAIC,SAAS,CAACC,MAAV,KAAqB,CAAzB,EAA4B;IAC1BF,QAAQ,GAAGD,IAAX;IACAA,IAAI,GAAG,EAAP;EACD;;EACD,IAAII,IAAI,GAAG,KAAKX,KAAL,CAAWY,GAAX,CAAeP,IAAf,KAAwB,EAAnC;EACA,IAAIQ,OAAO,GAAGF,IAAI,CAACD,MAAnB;EACA,IAAII,YAAY,GAAGH,IAAI,CAACI,QAAL,IAAiB,CAApC;EACA,IAAIC,UAAU,GAAG,CAAjB;EACA,IAAIC,aAAa,GAAGH,YAApB;EACA,IAAII,IAAI,GAAG,KAAX;EACA,IAAIC,KAAK,GAAGZ,IAAZ;;EAEA,IAAI,CAACM,OAAL,EAAc;IACZ,OAAOO,QAAQ,CAAC,YAAW;MACzBZ,QAAQ,CAAC,IAAD,CAAR;IACD,CAFc,CAAf;EAGD;;EAED,IAAIa,IAAI,GAAG,YAAW;IACpB,IAAIL,UAAU,IAAIH,OAAlB,EAA2B;MACzB;IACD;;IACD,IAAIS,GAAG,GAAGX,IAAI,CAACK,UAAD,CAAd;;IAEA,IAAIM,GAAG,CAACC,OAAR,EAAiB;MACf,IAAIhB,IAAI,GAAG,CACTiB,cAAc,CAACC,KAAD,CADL,EAETD,cAAc,CAAC,UAASE,KAAT,EAAgB;QAC7B,IAAIA,KAAJ,EAAW;UACT,IAAIR,IAAJ,EAAU;YACR;UACD;;UACDA,IAAI,GAAG,IAAP;UACA,OAAOV,QAAQ,CAACkB,KAAD,CAAf;QACD;;QACD,IAAI,EAAET,aAAF,KAAoB,CAApB,IAAyBD,UAAU,IAAIH,OAA3C,EAAoD;UAClD,OAAOL,QAAQ,CAAC,IAAD,CAAf;QACD;MACF,CAXa,CAFL,CAAX;MAgBAmB,sBAAsB,CAACL,GAAG,CAACM,EAAL,EAAStB,OAAT,EAAkBC,IAAlB,EAAwBA,IAAI,CAAC,CAAD,CAA5B,CAAtB;IACD,CAlBD,MAkBO,IAAIe,GAAG,CAACM,EAAJ,CAAOlB,MAAP,GAAgB,CAApB,EAAuB;MAC5B,IAAIH,IAAI,GAAG,CAACiB,cAAc,CAACC,KAAD,CAAf,CAAX;;MACA,IAAII,KAAK,GAAGpB,SAAS,CAACC,MAAV,IAAoB,CAApB,GAAwBD,SAAxB,GAAoC,CAAC,IAAD,EAAOqB,MAAP,CAAcX,KAAd,CAAhD;;MACA,KAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,KAAK,CAACnB,MAA1B,EAAkC,EAAEqB,CAApC,EAAuC;QACrCxB,IAAI,CAACyB,IAAL,CAAUH,KAAK,CAACE,CAAD,CAAf;MACD;;MAEDJ,sBAAsB,CAACL,GAAG,CAACM,EAAL,EAAStB,OAAT,EAAkBC,IAAlB,EAAwBA,IAAI,CAAC,CAAD,CAA5B,CAAtB;IACD,CARM,MAQA;MACL,IAAI0B,gBAAgB,GAAG,IAAvB;;MACA,IAAI;QACFA,gBAAgB,GAAGX,GAAG,CAACM,EAAJ,CAAOM,IAAP,CAAY5B,OAAZ,CAAnB;MACD,CAFD,CAEE,OAAO6B,GAAP,EAAY;QACZ,IAAIA,GAAG,IAAI,IAAX,EAAiB;UACf,OAAO3B,QAAQ,CAAC2B,GAAD,CAAf;QACD;MACF;;MAED,IAAIC,aAAa,CAACH,gBAAD,CAAjB,EAAqC;QACnCA,gBAAgB,CAACI,IAAjB,CAAsB,MAAMZ,KAAK,EAAjC,EAAqCU,GAAG,IAAIV,KAAK,CAACU,GAAD,CAAjD;MACD,CAFD,MAEO;QACL,IAAI,EAAEnB,UAAF,IAAgBH,OAApB,EAA6B;UAC3B,IAAII,aAAa,GAAG,CAApB,EAAuB;YACrB;YACA;UACD,CAHD,MAGO;YACL,OAAOG,QAAQ,CAAC,YAAW;cACzBZ,QAAQ,CAAC,IAAD,CAAR;YACD,CAFc,CAAf;UAGD;QACF;;QACDa,IAAI;MACL;IACF;EACF,CA1DD;;EA4DAA,IAAI,CAACiB,KAAL,CAAW,IAAX,EAAiB,CAAC,IAAD,EAAOR,MAAP,CAAcvB,IAAd,CAAjB;;EAEA,SAASkB,KAAT,CAAeC,KAAf,EAAsB;IACpB,IAAIA,KAAJ,EAAW;MACT,IAAIR,IAAJ,EAAU;QACR;MACD;;MACDA,IAAI,GAAG,IAAP;MACA,OAAOV,QAAQ,CAACkB,KAAD,CAAf;IACD;;IAED,IAAI,EAAEV,UAAF,IAAgBH,OAApB,EAA6B;MAC3B,IAAII,aAAa,GAAG,CAApB,EAAuB;QACrB;QACA;MACD,CAHD,MAGO;QACL,OAAOT,QAAQ,CAAC,IAAD,CAAf;MACD;IACF;;IAEDa,IAAI,CAACiB,KAAL,CAAWhC,OAAX,EAAoBG,SAApB;EACD;AACF,CArGD;;AAuGAV,MAAM,CAACI,SAAP,CAAiBoC,WAAjB,GAA+B,UAASlC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,EAA8B;EAC3D,IAAII,IAAI,GAAG,KAAKX,KAAL,CAAWY,GAAX,CAAeP,IAAf,KAAwB,EAAnC;EACA,IAAIQ,OAAO,GAAGF,IAAI,CAACD,MAAnB;;EAEA,KAAK,IAAIqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,OAApB,EAA6B,EAAEkB,CAA/B,EAAkC;IAChCpB,IAAI,CAACoB,CAAD,CAAJ,CAAQH,EAAR,CAAWU,KAAX,CAAiBhC,OAAjB,EAA0BC,IAAI,IAAI,EAAlC;EACD;AACF,CAPD;;AASAR,MAAM,CAACI,SAAP,CAAiBqC,QAAjB,GAA4B,UAASnC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,EAA8BkC,OAA9B,EAAuCjC,QAAvC,EAAiD;EAC3E,IAAIC,SAAS,CAACC,MAAV,GAAmB,CAAvB,EAA0B;IACxBF,QAAQ,GAAGiC,OAAX;IACAA,OAAO,GAAG,IAAV;EACD;;EACD,IAAIC,KAAK,GAAG,KAAKxC,MAAL,CAAYU,GAAZ,CAAgBP,IAAhB,KAAyB,EAArC;EACA,IAAIsC,QAAQ,GAAGD,KAAK,CAAChC,MAArB;EACA,IAAIkC,WAAW,GAAG,CAAlB;EAEA,IAAIC,UAAU,GAAG,IAAjB;;EACA,IAAIJ,OAAO,IAAIA,OAAO,CAACf,KAAvB,EAA8B;IAC5BmB,UAAU,GAAGJ,OAAO,CAACf,KAArB;EACD;;EAED,IAAI,CAACiB,QAAL,EAAe;IACb,OAAOvB,QAAQ,CAAC,YAAW;MACzBZ,QAAQ,CAAC8B,KAAT,CAAe,IAAf,EAAqB,CAACO,UAAD,EAAaf,MAAb,CAAoBvB,IAApB,CAArB;IACD,CAFc,CAAf;EAGD;;EAED,IAAIc,IAAI,GAAG,YAAW;IACpB,IAAIyB,IAAI,GAAGJ,KAAK,CAACE,WAAD,CAAL,CAAmBhB,EAA9B;IACA,IAAImB,OAAO,GAAG,CAAd;IACA,IAAIC,SAAS,GAAGzC,IAAI,CAACG,MAArB;IACA,IAAIuC,OAAO,GAAG,EAAd;;IACA,KAAK,IAAIlB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiB,SAApB,EAA+B,EAAEjB,CAAjC,EAAoC;MAClCgB,OAAO,IAAIxC,IAAI,CAACwB,CAAD,CAAJ,IAAWxB,IAAI,CAACwB,CAAD,CAAJ,CAAQmB,aAAnB,GAAmC,CAAnC,GAAuC,CAAlD;;MACA,IAAI,CAAC3C,IAAI,CAACwB,CAAD,CAAL,IAAY,CAACxB,IAAI,CAACwB,CAAD,CAAJ,CAAQmB,aAAzB,EAAwC;QACtCD,OAAO,CAACjB,IAAR,CAAazB,IAAI,CAACwB,CAAD,CAAjB;MACD;IACF;;IAED,IAAIc,UAAJ,EAAgB;MACd,IAAIC,IAAI,CAACpC,MAAL,KAAgBqC,OAAO,GAAG,CAA9B,EAAiC;QAC/B,MAAMI,GAAG,GAAG3B,cAAc,CAAC,UAASE,KAAT,EAAgB;UACzC,IAAIA,KAAJ,EAAW;YACTmB,UAAU,GAAGnB,KAAb;UACD;;UACD,IAAI,EAAEkB,WAAF,IAAiBD,QAArB,EAA+B;YAC7B,OAAOnC,QAAQ,CAAC0B,IAAT,CAAc,IAAd,EAAoBW,UAApB,CAAP;UACD;;UACDxB,IAAI;QACL,CARyB,CAA1B;;QAUAM,sBAAsB,CAACmB,IAAD,EAAOxC,OAAP,EACpB,CAACuC,UAAD,EAAaf,MAAb,CAAoBmB,OAApB,EAA6BnB,MAA7B,CAAoC,CAACqB,GAAD,CAApC,CADoB,EACwBA,GADxB,CAAtB;MAED,CAbD,MAaO;QACL,IAAI,EAAEP,WAAF,IAAiBD,QAArB,EAA+B;UAC7B,OAAOnC,QAAQ,CAAC0B,IAAT,CAAc,IAAd,EAAoBW,UAApB,CAAP;QACD;;QACDxB,IAAI;MACL;IACF,CApBD,MAoBO;MACL,MAAM8B,GAAG,GAAG3B,cAAc,CAAC,UAASE,KAAT,EAAgB;QACzC,IAAIA,KAAJ,EAAW;UACTmB,UAAU,GAAGnB,KAAb;UACA,OAAOL,IAAI,EAAX;QACD;;QAED,IAAI,EAAEuB,WAAF,IAAiBD,QAArB,EAA+B;UAC7B,OAAOnC,QAAQ,CAAC8B,KAAT,CAAe,IAAf,EAAqB,CAAC,IAAD,EAAOR,MAAP,CAAcvB,IAAd,CAArB,CAAP;QACD;;QAEDc,IAAI;MACL,CAXyB,CAA1B;;MAaA,IAAIyB,IAAI,CAACpC,MAAL,KAAgBqC,OAAO,GAAG,CAA9B,EAAiC;QAC/B;QACA,IAAI,EAAEH,WAAF,IAAiBD,QAArB,EAA+B;UAC7B,OAAOnC,QAAQ,CAAC8B,KAAT,CAAe,IAAf,EAAqB,CAAC,IAAD,EAAOR,MAAP,CAAcvB,IAAd,CAArB,CAAP;QACD;;QACD,OAAOc,IAAI,EAAX;MACD;;MACD,IAAIyB,IAAI,CAACpC,MAAL,KAAgBqC,OAAO,GAAG,CAA9B,EAAiC;QAC/BpB,sBAAsB,CAACmB,IAAD,EAAOxC,OAAP,EAAgB2C,OAAO,CAACnB,MAAR,CAAe,CAACqB,GAAD,CAAf,CAAhB,EAAuCA,GAAvC,CAAtB;MACD,CAFD,MAEO;QACL,IAAIzB,KAAJ;QACA,IAAIO,gBAAJ;;QACA,IAAI;UACFA,gBAAgB,GAAGa,IAAI,CAACR,KAAL,CAAWhC,OAAX,EAAoB2C,OAApB,CAAnB;QACD,CAFD,CAEE,OAAOd,GAAP,EAAY;UACZT,KAAK,GAAGS,GAAR;UACAU,UAAU,GAAGV,GAAb;QACD;;QAED,IAAIC,aAAa,CAACH,gBAAD,CAAjB,EAAqC;UACnC,OAAOA,gBAAgB,CAACI,IAAjB,CAAsB,MAAMc,GAAG,EAA/B,EAAmChB,GAAG,IAAIgB,GAAG,CAAChB,GAAD,CAA7C,CAAP;QACD;;QAED,IAAI,EAAES,WAAF,IAAiBD,QAArB,EAA+B;UAC7B,OAAOnC,QAAQ,CAAC8B,KAAT,CAAe,IAAf,EAAqB,CAACZ,KAAD,EAAQI,MAAR,CAAevB,IAAf,CAArB,CAAP;QACD;;QAEDc,IAAI;MACL;IACF;EACF,CA5ED;;EA8EAA,IAAI;AACL,CAnGD;;AAqGAtB,MAAM,CAACI,SAAP,CAAiBiD,YAAjB,GAAgC,UAAS/C,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,EAA8B;EAC5D,MAAMmC,KAAK,GAAG,KAAKxC,MAAL,CAAYU,GAAZ,CAAgBP,IAAhB,KAAyB,EAAvC;EACA,MAAMsC,QAAQ,GAAGD,KAAK,CAAChC,MAAvB;;EAEA,KAAK,IAAIqB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGY,QAApB,EAA8B,EAAEZ,CAAhC,EAAmC;IACjCW,KAAK,CAACX,CAAD,CAAL,CAASH,EAAT,CAAYU,KAAZ,CAAkBhC,OAAlB,EAA2BC,IAAI,IAAI,EAAnC;EACD;AACF,CAPD;;AASAR,MAAM,CAACI,SAAP,CAAiBkD,iBAAjB,GAAqC,UAAShD,IAAT,EAAeuB,EAAf,EAAmB;EACtD,IAAI0B,MAAM,GAAG,IAAb;EACA,OAAO,SAASC,WAAT,GAAuB;IAC5BD,MAAM,CAACf,WAAP,CAAmBlC,IAAnB,EAAyB,IAAzB,EAA+BI,SAA/B;IAEA,IAAI+C,QAAQ,GAAG5B,EAAE,CAACU,KAAH,CAAS,IAAT,EAAe7B,SAAf,CAAf;IAEA6C,MAAM,CAACF,YAAP,CAAoB/C,IAApB,EAA0B,IAA1B,EAAgC,CAACmD,QAAD,CAAhC;IAEA,OAAOA,QAAP;EACD,CARD;AASD,CAXD;;AAaA,SAASC,gBAAT,CAA0BC,QAA1B,EAAoChC,KAApC,EAA2CrB,IAA3C,EAAiDC,OAAjD,EAA0DC,IAA1D,EAAgEkC,OAAhE,EAAyEjC,QAAzE,EAAmF;EACjF,IAAIiC,OAAO,CAACkB,gBAAZ,EAA8B;IAC5B,OAAOD,QAAQ,CAAClB,QAAT,CAAkBnC,IAAlB,EAAwBC,OAAxB,EAAiCC,IAAjC,EAAuC;MAAEmB,KAAK,EAAEA;IAAT,CAAvC,EAAyD,UAASA,KAAT,EAAgB;MAC9E,OAAO,OAAOlB,QAAP,KAAoB,UAApB,IAAkCA,QAAQ,CAACkB,KAAD,CAAjD;IACD,CAFM,CAAP;EAGD,CAJD,MAIO;IACL,OAAO,OAAOlB,QAAP,KAAoB,UAApB,IAAkCA,QAAQ,CAACkB,KAAD,CAAjD;EACD;AACF;;AAED3B,MAAM,CAACI,SAAP,CAAiByD,IAAjB,GAAwB,UAASvD,IAAT,EAAeuB,EAAf,EAAmBtB,OAAnB,EAA4BC,IAA5B,EAAkCkC,OAAlC,EAA2C;EACjE,MAAMoB,OAAO,GAAItD,IAAI,CAACG,MAAL,GAAc,CAAd,GAAkBH,IAAI,CAACA,IAAI,CAACG,MAAL,GAAc,CAAf,CAAtB,GAA0C,IAA3D;EACA,MAAMoD,aAAa,GAAGC,KAAK,CAACC,IAAN,CAAWzD,IAAX,CAAtB;EACA,OAAOsD,OAAP,KAAmB,UAAnB,IAAiCC,aAAa,CAACG,GAAd,EAAjC;;EACA,MAAMC,KAAK,GAAG,IAAd;;EAEAzB,OAAO,GAAGA,OAAO,IAAI,EAArB;EACA,MAAM0B,eAAe,GAAG1B,OAAO,CAAC0B,eAAhC;EAEA,KAAK/D,OAAL,CAAaC,IAAb,EAAmBC,OAAnB,EAA4BC,IAA5B,EAAkC,UAASmB,KAAT,EAAgB;IAChD,IAAIA,KAAJ,EAAW;MACT,MAAM0C,iBAAiB,GAAG3B,OAAO,CAAC2B,iBAAR,IAA6B,CAAvD;MACA,MAAMC,SAAS,GAAG5B,OAAO,CAAC6B,gBAAR,GAA2B,CAAChE,OAAD,CAA3B,GAAuC,EAAzD;;MACA,KAAK,IAAIyB,CAAC,GAAGsC,SAAS,CAAC3D,MAAvB,EAA+BqB,CAAC,GAAGqC,iBAAnC,EAAsD,EAAErC,CAAxD,EAA2D;QACzDsC,SAAS,CAACrC,IAAV,CAAe,IAAf;MACD;;MACD,OAAOyB,gBAAgB,CAACS,KAAD,EAAQxC,KAAR,EAAerB,IAAf,EAAqBC,OAArB,EAA8B+D,SAA9B,EACrB5B,OADqB,EACZoB,OADY,CAAvB;IAED;;IAED,MAAMU,aAAa,GAAG3C,EAAE,CAAClB,MAAzB;IACA,IAAI8D,GAAJ;;IACA,IAAI;MACFA,GAAG,GAAG5C,EAAE,CAACU,KAAH,CAAShC,OAAT,EAAkBwD,aAAa,CAAChC,MAAd,CAAqBqB,GAArB,CAAlB,CAAN;IACD,CAFD,CAEE,OAAOhB,GAAP,EAAY;MACZ,OAAOgB,GAAG,CAAChB,GAAD,CAAV;IACD;;IAED,IAAIgC,eAAJ,EAAqB;MACnB,IAAI/B,aAAa,CAACoC,GAAD,CAAjB,EAAwB;QACtB;QACA,OAAOA,GAAG,CAACnC,IAAJ,CACLoC,GAAG,IAAItB,GAAG,CAAC,IAAD,EAAOsB,GAAP,CADL,EAELtC,GAAG,IAAIgB,GAAG,CAAChB,GAAD,CAFL,CAAP;MAID,CAPkB,CASnB;MACA;;;MACA,IAAIoC,aAAa,GAAGT,aAAa,CAACpD,MAAd,GAAuB,CAA3C,EAA8C;QAC5C,OAAOyC,GAAG,CAAC,IAAD,EAAOqB,GAAP,CAAV;MACD;IACF;;IAED,SAASrB,GAAT,GAAe;MACb,MAAMuB,gBAAgB,GAAGX,KAAK,CAACC,IAAN,CAAWvD,SAAX,CAAzB;MACAiE,gBAAgB,CAACC,KAAjB;;MACA,IAAIlC,OAAO,CAACmC,mBAAR,IAA+BF,gBAAgB,CAAChE,MAAjB,KAA4B,CAA/D,EAAkE;QAChEgE,gBAAgB,CAAC1C,IAAjB,CAAsB,IAAtB;MACD;;MACD,IAAIvB,SAAS,CAAC,CAAD,CAAb,EAAkB;QAChB;QACA,OAAOgD,gBAAgB,CAACS,KAAD,EAAQzD,SAAS,CAAC,CAAD,CAAjB,EAAsBJ,IAAtB,EAA4BC,OAA5B,EACrBoE,gBADqB,EACHjC,OADG,EACMoB,OADN,CAAvB;MAED,CAJD,MAIO;QACLK,KAAK,CAAC1B,QAAN,CAAenC,IAAf,EAAqBC,OAArB,EAA8BoE,gBAA9B,EAAgD,YAAW;UACzD,IAAIb,OAAO,KAAK,IAAhB,EAAsB;YACpB;UACD;;UACDpD,SAAS,CAAC,CAAD,CAAT,GACIoD,OAAO,CAACpD,SAAS,CAAC,CAAD,CAAV,CADX,GAEIoD,OAAO,CAACvB,KAAR,CAAchC,OAAd,EAAuBG,SAAvB,CAFJ;QAGD,CAPD;MAQD;IACF;EACF,CAxDD;AAyDD,CAlED;;AAoEAV,MAAM,CAACI,SAAP,CAAiB0E,MAAjB,GAA0B,UAASjD,EAAT,EAAa;EACrC,MAAMkD,KAAK,GAAG,KAAKA,KAAL,EAAd;EAEA,MAAMnE,IAAI,GAAGoD,KAAK,CAACC,IAAN,CAAWc,KAAK,CAAC9E,KAAN,CAAY+E,IAAZ,EAAX,CAAb;;EACA,KAAK,MAAM1E,IAAX,IAAmBM,IAAnB,EAAyB;IACvB,MAAMqE,KAAK,GAAG,KAAKhF,KAAL,CAAWY,GAAX,CAAeP,IAAf,EACZ4E,GADY,CACRC,CAAC,IAAIC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,CAAlB,EAAqB;MAAE7E,IAAI,EAAEA;IAAR,CAArB,CADG,EAEZwE,MAFY,CAELjD,EAFK,CAAd;;IAIA,IAAIoD,KAAK,CAACtE,MAAN,KAAiB,CAArB,EAAwB;MACtBoE,KAAK,CAAC9E,KAAN,CAAYqF,MAAZ,CAAmBhF,IAAnB;;MACA;IACD;;IAED2E,KAAK,CAACjE,QAAN,GAAiBiE,KAAK,CAACH,MAAN,CAAaK,CAAC,IAAIA,CAAC,CAAC3D,OAApB,EAA6Bb,MAA9C;;IAEAoE,KAAK,CAAC9E,KAAN,CAAYsF,GAAZ,CAAgBjF,IAAhB,EAAsB2E,KAAtB;EACD;;EAED,MAAMtC,KAAK,GAAGqB,KAAK,CAACC,IAAN,CAAWc,KAAK,CAAC5E,MAAN,CAAa6E,IAAb,EAAX,CAAd;;EACA,KAAK,MAAM1E,IAAX,IAAmBqC,KAAnB,EAA0B;IACxB,MAAMsC,KAAK,GAAG,KAAK9E,MAAL,CAAYU,GAAZ,CAAgBP,IAAhB,EACZ4E,GADY,CACRC,CAAC,IAAIC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,CAAlB,EAAqB;MAAE7E,IAAI,EAAEA;IAAR,CAArB,CADG,EAEZwE,MAFY,CAELjD,EAFK,CAAd;;IAIA,IAAIoD,KAAK,CAACtE,MAAN,KAAiB,CAArB,EAAwB;MACtBoE,KAAK,CAAC5E,MAAN,CAAamF,MAAb,CAAoBhF,IAApB;;MACA;IACD;;IAEDyE,KAAK,CAAC5E,MAAN,CAAaoF,GAAb,CAAiBjF,IAAjB,EAAuB2E,KAAvB;EACD;;EAED,OAAOF,KAAP;AACD,CAlCD;;AAoCA/E,MAAM,CAACI,SAAP,CAAiBoF,QAAjB,GAA4B,UAASlF,IAAT,EAAe;EACzC,OAAO,KAAKL,KAAL,CAAWwF,GAAX,CAAenF,IAAf,KAAwB,KAAKH,MAAL,CAAYsF,GAAZ,CAAgBnF,IAAhB,CAA/B;AACD,CAFD;;AAIAN,MAAM,CAACI,SAAP,CAAiBsF,aAAjB,GAAiC,UAASpF,IAAT,EAAeuB,EAAf,EAAmBtB,OAAnB,EAA4BmC,OAA5B,EAAqC;EACpE,IAAIyB,KAAK,GAAG,IAAZ;;EACA,IAAI,CAAC,KAAKqB,QAAL,CAAclF,IAAd,CAAL,EAA0B;IACxB;IACA;IACA,OAAO,YAAW;MAChBe,QAAQ,CAAC,MAAMQ,EAAE,CAACU,KAAH,CAAS,IAAT,EAAe7B,SAAf,CAAP,CAAR;IACD,CAFD;EAGD;;EACD,OAAO,YAAW;IAChB,IAAIiF,QAAQ,GAAGpF,OAAO,IAAI,IAA1B;;IACA4D,KAAK,CAACN,IAAN,CAAWvD,IAAX,EAAiBuB,EAAjB,EAAqB8D,QAArB,EAA+B3B,KAAK,CAACC,IAAN,CAAWvD,SAAX,CAA/B,EAAsDgC,OAAtD;EACD,CAHD;AAID,CAbD;;AAeA1C,MAAM,CAACI,SAAP,CAAiBmB,GAAjB,GAAuB,UAASjB,IAAT,EAAekB,OAAf,EAAwBK,EAAxB,EAA4BF,KAA5B,EAAmCiE,OAAnC,EAA4C;EACjE,IAAIlD,OAAO,GAAG,EAAd;;EACA,IAAI,OAAOlB,OAAP,KAAmB,QAAnB,IAA+BA,OAAO,KAAK,IAA/C,EAAqD;IACnDkB,OAAO,GAAGlB,OAAV;IACAA,OAAO,GAAGkB,OAAO,CAAClB,OAAlB;EACD,CAHD,MAGO,IAAI,OAAOd,SAAS,CAAC,CAAD,CAAhB,KAAwB,SAA5B,EAAuC;IAC5CmB,EAAE,GAAGL,OAAL;IACAA,OAAO,GAAG,KAAV;EACD;;EAED,MAAMZ,IAAI,GAAG,KAAKX,KAAL,CAAWY,GAAX,CAAeP,IAAf,KAAwB,EAArC;;EACA,KAAKL,KAAL,CAAWsF,GAAX,CAAejF,IAAf,EAAqBM,IAArB;;EAEA,IAAIY,OAAJ,EAAa;IACXZ,IAAI,CAACI,QAAL,GAAgBJ,IAAI,CAACI,QAAL,IAAiB,CAAjC;IACA,EAAEJ,IAAI,CAACI,QAAP;EACD;;EAED,IAAI,OAAOa,EAAP,KAAc,UAAlB,EAA8B;IAC5B,MAAM,IAAIgE,KAAJ,CAAU,qCAAqC,OAAOhE,EAA5C,GAAiD,GAA3D,CAAN;EACD;;EAED,IAAI+D,OAAJ,EAAa;IACXhF,IAAI,CAACgF,OAAL,CAAaR,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB3C,OAAlB,EAA2B;MAAEb,EAAE,EAAEA,EAAN;MAAUL,OAAO,EAAEA;IAAnB,CAA3B,CAAb;EACD,CAFD,MAEO;IACLZ,IAAI,CAACqB,IAAL,CAAUmD,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB3C,OAAlB,EAA2B;MAAEb,EAAE,EAAEA,EAAN;MAAUL,OAAO,EAAEA;IAAnB,CAA3B,CAAV;EACD;;EAED,OAAO,IAAP;AACD,CA7BD;;AA+BAxB,MAAM,CAACI,SAAP,CAAiB2C,IAAjB,GAAwB,UAASzC,IAAT,EAAeoC,OAAf,EAAwBb,EAAxB,EAA4B+D,OAA5B,EAAqC;EAC3D,MAAMX,KAAK,GAAG,KAAK9E,MAAL,CAAYU,GAAZ,CAAgBP,IAAhB,KAAyB,EAAvC;;EAEA,IAAI,OAAOoC,OAAP,KAAmB,UAAvB,EAAmC;IACjCkD,OAAO,GAAG,CAAC,CAAC/D,EAAZ;IACAA,EAAE,GAAGa,OAAL;IACAA,OAAO,GAAG,EAAV;EACD;;EAED,IAAI,OAAOb,EAAP,KAAc,UAAlB,EAA8B;IAC5B,MAAM,IAAIgE,KAAJ,CAAU,sCAAsC,OAAOhE,EAA7C,GAAkD,GAA5D,CAAN;EACD;;EAED,IAAI+D,OAAJ,EAAa;IACXX,KAAK,CAACW,OAAN,CAAcR,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB3C,OAAlB,EAA2B;MAAEb,EAAE,EAAEA;IAAN,CAA3B,CAAd;EACD,CAFD,MAEO;IACLoD,KAAK,CAAChD,IAAN,CAAWmD,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB3C,OAAlB,EAA2B;MAAEb,EAAE,EAAEA;IAAN,CAA3B,CAAX;EACD;;EACD,KAAK1B,MAAL,CAAYoF,GAAZ,CAAgBjF,IAAhB,EAAsB2E,KAAtB;;EACA,OAAO,IAAP;AACD,CApBD;;AAsBAjF,MAAM,CAACI,SAAP,CAAiB2E,KAAjB,GAAyB,YAAW;EAClC,MAAMe,CAAC,GAAG,IAAI9F,MAAJ,EAAV;;EAEA,KAAK,IAAI+F,GAAT,IAAgB,KAAK9F,KAAL,CAAW+E,IAAX,EAAhB,EAAmC;IACjC,MAAMD,KAAK,GAAG,KAAK9E,KAAL,CAAWY,GAAX,CAAekF,GAAf,EAAoBC,KAApB,EAAd;;IACAjB,KAAK,CAAC/D,QAAN,GAAiB,KAAKf,KAAL,CAAWY,GAAX,CAAekF,GAAf,EAAoB/E,QAArC;;IACA8E,CAAC,CAAC7F,KAAF,CAAQsF,GAAR,CAAYQ,GAAZ,EAAiBhB,KAAjB;EACD;;EACD,KAAK,IAAIgB,GAAT,IAAgB,KAAK5F,MAAL,CAAY6E,IAAZ,EAAhB,EAAoC;IAClCc,CAAC,CAAC3F,MAAF,CAASoF,GAAT,CAAaQ,GAAb,EAAkB,KAAK5F,MAAL,CAAYU,GAAZ,CAAgBkF,GAAhB,EAAqBC,KAArB,EAAlB;EACD;;EAED,OAAOF,CAAP;AACD,CAbD;;AAeA9F,MAAM,CAACI,SAAP,CAAiB6F,KAAjB,GAAyB,UAASC,KAAT,EAAgBnB,KAAhB,EAAuB;EAC9CA,KAAK,GAAGrE,SAAS,CAACC,MAAV,KAAqB,CAArB,GAAyB,IAAzB,GAAgCoE,KAAxC;EACA,IAAIN,GAAG,GAAGM,KAAK,GAAG,KAAKA,KAAL,EAAH,GAAkB,IAAjC;;EAEA,KAAK,IAAIgB,GAAT,IAAgBG,KAAK,CAACjG,KAAN,CAAY+E,IAAZ,EAAhB,EAAoC;IAClC,MAAMmB,UAAU,GAAG1B,GAAG,CAACxE,KAAJ,CAAUY,GAAV,CAAckF,GAAd,KAAsB,EAAzC;;IACA,MAAMK,YAAY,GAAGF,KAAK,CAACjG,KAAN,CAAYY,GAAZ,CAAgBkF,GAAhB,GACnB;IACAjB,MAFmB,CAEZuB,CAAC,IAAIF,UAAU,CAACjB,GAAX,CAAeoB,EAAE,IAAIA,EAAE,CAACzE,EAAxB,EAA4B0E,OAA5B,CAAoCF,CAAC,CAACxE,EAAtC,MAA8C,CAAC,CAFxC,CAArB;;IAGA,MAAM2E,QAAQ,GAAGL,UAAU,CAACpE,MAAX,CAAkBqE,YAAlB,CAAjB;IACAI,QAAQ,CAACxF,QAAT,GAAoBmF,UAAU,CAACnF,QAAX,IAAuB,CAA3C;IACAwF,QAAQ,CAACxF,QAAT,IAAqBoF,YAAY,CAACtB,MAAb,CAAoBuB,CAAC,IAAIA,CAAC,CAAC7E,OAA3B,EAAoCb,MAAzD;;IACA8D,GAAG,CAACxE,KAAJ,CAAUsF,GAAV,CAAcQ,GAAd,EAAmBS,QAAnB;EACD;;EACD,KAAK,IAAIT,GAAT,IAAgBG,KAAK,CAAC/F,MAAN,CAAa6E,IAAb,EAAhB,EAAqC;IACnC,MAAMyB,WAAW,GAAGhC,GAAG,CAACtE,MAAJ,CAAWU,GAAX,CAAekF,GAAf,KAAuB,EAA3C;;IACA,MAAMK,YAAY,GAAGF,KAAK,CAAC/F,MAAN,CAAaU,GAAb,CAAiBkF,GAAjB,EACnBjB,MADmB,CACZuB,CAAC,IAAII,WAAW,CAACF,OAAZ,CAAoBF,CAApB,MAA2B,CAAC,CADrB,CAArB;;IAEA5B,GAAG,CAACtE,MAAJ,CAAWoF,GAAX,CAAeQ,GAAf,EAAoBU,WAAW,CAAC1E,MAAZ,CAAmBqE,YAAnB,CAApB;EACD;;EAED,OAAO3B,GAAP;AACD,CAtBD;;AAwBA,SAAS7C,sBAAT,CAAgCC,EAAhC,EAAoCtB,OAApC,EAA6CC,IAA7C,EAAmDc,IAAnD,EAAyD;EACvD,IAAIY,gBAAJ;;EACA,IAAI;IACFA,gBAAgB,GAAGL,EAAE,CAACU,KAAH,CAAShC,OAAT,EAAkBC,IAAlB,CAAnB;EACD,CAFD,CAEE,OAAOmB,KAAP,EAAc;IACd,OAAOL,IAAI,CAACK,KAAD,CAAX;EACD;;EAED,IAAIU,aAAa,CAACH,gBAAD,CAAjB,EAAqC;IACnCA,gBAAgB,CAACI,IAAjB,CAAsB,MAAMhB,IAAI,EAAhC,EAAoCc,GAAG,IAAId,IAAI,CAACc,GAAD,CAA/C;EACD;AACF;;AAED,SAASC,aAAT,CAAuBqE,CAAvB,EAA0B;EACxB,OAAQ,OAAOA,CAAP,KAAa,QAAb,IAAyBA,CAAC,KAAK,IAA/B,IAAuC,OAAOA,CAAC,CAACpE,IAAT,KAAkB,UAAjE;AACD;;AAED,SAASb,cAAT,CAAwBI,EAAxB,EAA4B;EAC1B,IAAI8E,MAAM,GAAG,KAAb;;EACA,IAAIxC,KAAK,GAAG,IAAZ;;EACA,OAAO,YAAW;IAChB;IACA,IAAIwC,MAAJ,EAAY;MACV;IACD;;IACDA,MAAM,GAAG,IAAT,CALgB,CAMhB;IACA;;IACA,OAAOtF,QAAQ,CAAC,MAAMQ,EAAE,CAACU,KAAH,CAAS4B,KAAT,EAAgBzD,SAAhB,CAAP,CAAf;EACD,CATD;AAUD;;AAED,MAAMW,QAAQ,GAAG,OAAOuF,OAAP,KAAmB,QAAnB,IAA+BA,OAAO,KAAK,IAA3C,IAAmDA,OAAO,CAACvF,QAA3D,IAAuE,SAASA,QAAT,CAAkBwF,EAAlB,EAAsB;EAC5GC,UAAU,CAACD,EAAD,EAAK,CAAL,CAAV;AACD,CAFD;;AAIAE,MAAM,CAACC,OAAP,GAAiBhH,MAAjB"},"metadata":{},"sourceType":"script"}