{"ast":null,"code":"'use strict';\n\nconst ArrayMethods = require('../../array/methods');\n\nconst Document = require('../../../document');\n\nconst castObjectId = require('../../../cast/objectid');\n\nconst getDiscriminatorByValue = require('../../../helpers/discriminator/getDiscriminatorByValue');\n\nconst internalToObjectOptions = require('../../../options').internalToObjectOptions;\n\nconst utils = require('../../../utils');\n\nconst isBsonType = require('../../../helpers/isBsonType');\n\nconst arrayParentSymbol = require('../../../helpers/symbols').arrayParentSymbol;\n\nconst arrayPathSymbol = require('../../../helpers/symbols').arrayPathSymbol;\n\nconst arraySchemaSymbol = require('../../../helpers/symbols').arraySchemaSymbol;\n\nconst documentArrayParent = require('../../../helpers/symbols').documentArrayParent;\n\nconst methods = {\n  /*!\n   * ignore\n   */\n  toBSON() {\n    return this.toObject(internalToObjectOptions);\n  },\n\n  /*!\n   * ignore\n   */\n  getArrayParent() {\n    return this[arrayParentSymbol];\n  },\n\n  /**\n   * Overrides MongooseArray#cast\n   *\n   * @method _cast\n   * @api private\n   * @receiver MongooseDocumentArray\n   */\n  _cast(value, index) {\n    if (this[arraySchemaSymbol] == null) {\n      return value;\n    }\n\n    let Constructor = this[arraySchemaSymbol].casterConstructor;\n    const isInstance = Constructor.$isMongooseDocumentArray ? utils.isMongooseDocumentArray(value) : value instanceof Constructor;\n\n    if (isInstance || // Hack re: #5001, see #5005\n    value && value.constructor && value.constructor.baseCasterConstructor === Constructor) {\n      if (!(value[documentArrayParent] && value.__parentArray)) {\n        // value may have been created using array.create()\n        value[documentArrayParent] = this[arrayParentSymbol];\n        value.__parentArray = this;\n      }\n\n      value.$setIndex(index);\n      return value;\n    }\n\n    if (value === undefined || value === null) {\n      return null;\n    } // handle cast('string') or cast(ObjectId) etc.\n    // only objects are permitted so we can safely assume that\n    // non-objects are to be interpreted as _id\n\n\n    if (Buffer.isBuffer(value) || isBsonType(value, 'ObjectID') || !utils.isObject(value)) {\n      value = {\n        _id: value\n      };\n    }\n\n    if (value && Constructor.discriminators && Constructor.schema && Constructor.schema.options && Constructor.schema.options.discriminatorKey) {\n      if (typeof value[Constructor.schema.options.discriminatorKey] === 'string' && Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, value[Constructor.schema.options.discriminatorKey]);\n\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n\n    if (Constructor.$isMongooseDocumentArray) {\n      return Constructor.cast(value, this, undefined, undefined, index);\n    }\n\n    const ret = new Constructor(value, this, undefined, undefined, index);\n    ret.isNew = true;\n    return ret;\n  },\n\n  /**\n   * Searches array items for the first document with a matching _id.\n   *\n   * #### Example:\n   *\n   *     const embeddedDoc = m.array.id(some_id);\n   *\n   * @return {EmbeddedDocument|null} the subdocument or null if not found.\n   * @param {ObjectId|String|Number|Buffer} id\n   * @TODO cast to the _id based on schema for proper comparison\n   * @method id\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n  id(id) {\n    let casted;\n    let sid;\n\n    let _id;\n\n    try {\n      casted = castObjectId(id).toString();\n    } catch (e) {\n      casted = null;\n    }\n\n    for (const val of this) {\n      if (!val) {\n        continue;\n      }\n\n      _id = val.get('_id');\n\n      if (_id === null || typeof _id === 'undefined') {\n        continue;\n      } else if (_id instanceof Document) {\n        sid || (sid = String(id));\n\n        if (sid == _id._id) {\n          return val;\n        }\n      } else if (!isBsonType(id, 'ObjectID') && !isBsonType(_id, 'ObjectID')) {\n        if (id == _id || utils.deepEqual(id, _id)) {\n          return val;\n        }\n      } else if (casted == _id) {\n        return val;\n      }\n    }\n\n    return null;\n  },\n\n  /**\n   * Returns a native js Array of plain js objects\n   *\n   * #### Note:\n   *\n   * _Each sub-document is converted to a plain object by calling its `#toObject` method._\n   *\n   * @param {Object} [options] optional options to pass to each documents `toObject` method call during conversion\n   * @return {Array}\n   * @method toObject\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n  toObject(options) {\n    // `[].concat` coerces the return value into a vanilla JS array, rather\n    // than a Mongoose array.\n    return [].concat(this.map(function (doc) {\n      if (doc == null) {\n        return null;\n      }\n\n      if (typeof doc.toObject !== 'function') {\n        return doc;\n      }\n\n      return doc.toObject(options);\n    }));\n  },\n\n  $toObject() {\n    return this.constructor.prototype.toObject.apply(this, arguments);\n  },\n\n  /**\n   * Wraps [`Array#push`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/push) with proper change tracking.\n   *\n   * @param {Object} [args...]\n   * @api public\n   * @method push\n   * @memberOf MongooseDocumentArray\n   */\n  push() {\n    const ret = ArrayMethods.push.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Pulls items from the array atomically.\n   *\n   * @param {Object} [args...]\n   * @api public\n   * @method pull\n   * @memberOf MongooseDocumentArray\n   */\n  pull() {\n    const ret = ArrayMethods.pull.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /*!\n   * Wraps [`Array#shift`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/unshift) with proper change tracking.\n   */\n  shift() {\n    const ret = ArrayMethods.shift.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /*!\n   * Wraps [`Array#splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice) with proper change tracking and casting.\n   */\n  splice() {\n    const ret = ArrayMethods.splice.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Helper for console.log\n   *\n   * @method inspect\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n  inspect() {\n    return this.toObject();\n  },\n\n  /**\n   * Creates a subdocument casted to this schema.\n   *\n   * This is the same subdocument constructor used for casting.\n   *\n   * @param {Object} obj the value to cast to this arrays SubDocument schema\n   * @method create\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n  create(obj) {\n    let Constructor = this[arraySchemaSymbol].casterConstructor;\n\n    if (obj && Constructor.discriminators && Constructor.schema && Constructor.schema.options && Constructor.schema.options.discriminatorKey) {\n      if (typeof obj[Constructor.schema.options.discriminatorKey] === 'string' && Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, obj[Constructor.schema.options.discriminatorKey]);\n\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n\n    return new Constructor(obj, this);\n  },\n\n  /*!\n   * ignore\n   */\n  notify(event) {\n    const _this = this;\n\n    return function notify(val, _arr) {\n      _arr = _arr || _this;\n      let i = _arr.length;\n\n      while (i--) {\n        if (_arr[i] == null) {\n          continue;\n        }\n\n        switch (event) {\n          // only swap for save event for now, we may change this to all event types later\n          case 'save':\n            val = _this[i];\n            break;\n\n          default:\n            // NO-OP\n            break;\n        }\n\n        if (utils.isMongooseArray(_arr[i])) {\n          notify(val, _arr[i]);\n        } else if (_arr[i]) {\n          _arr[i].emit(event, val);\n        }\n      }\n    };\n  },\n\n  set(i, val, skipModified) {\n    const arr = this.__array;\n\n    if (skipModified) {\n      arr[i] = val;\n      return this;\n    }\n\n    const value = methods._cast.call(this, val, i);\n\n    methods._markModified.call(this, i);\n\n    arr[i] = value;\n    return this;\n  },\n\n  _markModified(elem, embeddedPath) {\n    const parent = this[arrayParentSymbol];\n    let dirtyPath;\n\n    if (parent) {\n      dirtyPath = this[arrayPathSymbol];\n\n      if (arguments.length) {\n        if (embeddedPath != null) {\n          // an embedded doc bubbled up the change\n          const index = elem.__index;\n          dirtyPath = dirtyPath + '.' + index + '.' + embeddedPath;\n        } else {\n          // directly set an index\n          dirtyPath = dirtyPath + '.' + elem;\n        }\n      }\n\n      if (dirtyPath != null && dirtyPath.endsWith('.$')) {\n        return this;\n      }\n\n      parent.markModified(dirtyPath, arguments.length !== 0 ? elem : parent);\n    }\n\n    return this;\n  }\n\n};\nmodule.exports = methods;\n/*!\n * If this is a document array, each element may contain single\n * populated paths, so we need to modify the top-level document's\n * populated cache. See gh-8247, gh-8265.\n */\n\nfunction _updateParentPopulated(arr) {\n  const parent = arr[arrayParentSymbol];\n  if (!parent || parent.$__.populated == null) return;\n  const populatedPaths = Object.keys(parent.$__.populated).filter(p => p.startsWith(arr[arrayPathSymbol] + '.'));\n\n  for (const path of populatedPaths) {\n    const remnant = path.slice((arr[arrayPathSymbol] + '.').length);\n\n    if (!Array.isArray(parent.$__.populated[path].value)) {\n      continue;\n    }\n\n    parent.$__.populated[path].value = arr.map(val => val.$populated(remnant));\n  }\n}","map":{"version":3,"names":["ArrayMethods","require","Document","castObjectId","getDiscriminatorByValue","internalToObjectOptions","utils","isBsonType","arrayParentSymbol","arrayPathSymbol","arraySchemaSymbol","documentArrayParent","methods","toBSON","toObject","getArrayParent","_cast","value","index","Constructor","casterConstructor","isInstance","$isMongooseDocumentArray","isMongooseDocumentArray","constructor","baseCasterConstructor","__parentArray","$setIndex","undefined","Buffer","isBuffer","isObject","_id","discriminators","schema","options","discriminatorKey","constructorByValue","cast","ret","isNew","id","casted","sid","toString","e","val","get","String","deepEqual","concat","map","doc","$toObject","prototype","apply","arguments","push","_updateParentPopulated","pull","shift","splice","inspect","create","obj","notify","event","_this","_arr","i","length","isMongooseArray","emit","set","skipModified","arr","__array","call","_markModified","elem","embeddedPath","parent","dirtyPath","__index","endsWith","markModified","module","exports","$__","populated","populatedPaths","Object","keys","filter","p","startsWith","path","remnant","slice","Array","isArray","$populated"],"sources":["B:/web_project_react/web_car_react/node_modules/mongoose/lib/types/DocumentArray/methods/index.js"],"sourcesContent":["'use strict';\n\nconst ArrayMethods = require('../../array/methods');\nconst Document = require('../../../document');\nconst castObjectId = require('../../../cast/objectid');\nconst getDiscriminatorByValue = require('../../../helpers/discriminator/getDiscriminatorByValue');\nconst internalToObjectOptions = require('../../../options').internalToObjectOptions;\nconst utils = require('../../../utils');\nconst isBsonType = require('../../../helpers/isBsonType');\n\nconst arrayParentSymbol = require('../../../helpers/symbols').arrayParentSymbol;\nconst arrayPathSymbol = require('../../../helpers/symbols').arrayPathSymbol;\nconst arraySchemaSymbol = require('../../../helpers/symbols').arraySchemaSymbol;\nconst documentArrayParent = require('../../../helpers/symbols').documentArrayParent;\n\nconst methods = {\n  /*!\n   * ignore\n   */\n\n  toBSON() {\n    return this.toObject(internalToObjectOptions);\n  },\n\n  /*!\n   * ignore\n   */\n\n  getArrayParent() {\n    return this[arrayParentSymbol];\n  },\n\n  /**\n   * Overrides MongooseArray#cast\n   *\n   * @method _cast\n   * @api private\n   * @receiver MongooseDocumentArray\n   */\n\n  _cast(value, index) {\n    if (this[arraySchemaSymbol] == null) {\n      return value;\n    }\n    let Constructor = this[arraySchemaSymbol].casterConstructor;\n    const isInstance = Constructor.$isMongooseDocumentArray ?\n      utils.isMongooseDocumentArray(value) :\n      value instanceof Constructor;\n    if (isInstance ||\n        // Hack re: #5001, see #5005\n        (value && value.constructor && value.constructor.baseCasterConstructor === Constructor)) {\n      if (!(value[documentArrayParent] && value.__parentArray)) {\n        // value may have been created using array.create()\n        value[documentArrayParent] = this[arrayParentSymbol];\n        value.__parentArray = this;\n      }\n      value.$setIndex(index);\n      return value;\n    }\n\n    if (value === undefined || value === null) {\n      return null;\n    }\n\n    // handle cast('string') or cast(ObjectId) etc.\n    // only objects are permitted so we can safely assume that\n    // non-objects are to be interpreted as _id\n    if (Buffer.isBuffer(value) ||\n        isBsonType(value, 'ObjectID') || !utils.isObject(value)) {\n      value = { _id: value };\n    }\n\n    if (value &&\n        Constructor.discriminators &&\n        Constructor.schema &&\n        Constructor.schema.options &&\n        Constructor.schema.options.discriminatorKey) {\n      if (typeof value[Constructor.schema.options.discriminatorKey] === 'string' &&\n          Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[value[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, value[Constructor.schema.options.discriminatorKey]);\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n\n    if (Constructor.$isMongooseDocumentArray) {\n      return Constructor.cast(value, this, undefined, undefined, index);\n    }\n    const ret = new Constructor(value, this, undefined, undefined, index);\n    ret.isNew = true;\n    return ret;\n  },\n\n  /**\n   * Searches array items for the first document with a matching _id.\n   *\n   * #### Example:\n   *\n   *     const embeddedDoc = m.array.id(some_id);\n   *\n   * @return {EmbeddedDocument|null} the subdocument or null if not found.\n   * @param {ObjectId|String|Number|Buffer} id\n   * @TODO cast to the _id based on schema for proper comparison\n   * @method id\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  id(id) {\n    let casted;\n    let sid;\n    let _id;\n\n    try {\n      casted = castObjectId(id).toString();\n    } catch (e) {\n      casted = null;\n    }\n\n    for (const val of this) {\n      if (!val) {\n        continue;\n      }\n\n      _id = val.get('_id');\n\n      if (_id === null || typeof _id === 'undefined') {\n        continue;\n      } else if (_id instanceof Document) {\n        sid || (sid = String(id));\n        if (sid == _id._id) {\n          return val;\n        }\n      } else if (!isBsonType(id, 'ObjectID') && !isBsonType(_id, 'ObjectID')) {\n        if (id == _id || utils.deepEqual(id, _id)) {\n          return val;\n        }\n      } else if (casted == _id) {\n        return val;\n      }\n    }\n\n    return null;\n  },\n\n  /**\n   * Returns a native js Array of plain js objects\n   *\n   * #### Note:\n   *\n   * _Each sub-document is converted to a plain object by calling its `#toObject` method._\n   *\n   * @param {Object} [options] optional options to pass to each documents `toObject` method call during conversion\n   * @return {Array}\n   * @method toObject\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  toObject(options) {\n    // `[].concat` coerces the return value into a vanilla JS array, rather\n    // than a Mongoose array.\n    return [].concat(this.map(function(doc) {\n      if (doc == null) {\n        return null;\n      }\n      if (typeof doc.toObject !== 'function') {\n        return doc;\n      }\n      return doc.toObject(options);\n    }));\n  },\n\n  $toObject() {\n    return this.constructor.prototype.toObject.apply(this, arguments);\n  },\n\n  /**\n   * Wraps [`Array#push`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/push) with proper change tracking.\n   *\n   * @param {Object} [args...]\n   * @api public\n   * @method push\n   * @memberOf MongooseDocumentArray\n   */\n\n  push() {\n    const ret = ArrayMethods.push.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Pulls items from the array atomically.\n   *\n   * @param {Object} [args...]\n   * @api public\n   * @method pull\n   * @memberOf MongooseDocumentArray\n   */\n\n  pull() {\n    const ret = ArrayMethods.pull.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /*!\n   * Wraps [`Array#shift`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/unshift) with proper change tracking.\n   */\n\n  shift() {\n    const ret = ArrayMethods.shift.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /*!\n   * Wraps [`Array#splice`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice) with proper change tracking and casting.\n   */\n\n  splice() {\n    const ret = ArrayMethods.splice.apply(this, arguments);\n\n    _updateParentPopulated(this);\n\n    return ret;\n  },\n\n  /**\n   * Helper for console.log\n   *\n   * @method inspect\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  inspect() {\n    return this.toObject();\n  },\n\n  /**\n   * Creates a subdocument casted to this schema.\n   *\n   * This is the same subdocument constructor used for casting.\n   *\n   * @param {Object} obj the value to cast to this arrays SubDocument schema\n   * @method create\n   * @api public\n   * @memberOf MongooseDocumentArray\n   */\n\n  create(obj) {\n    let Constructor = this[arraySchemaSymbol].casterConstructor;\n    if (obj &&\n        Constructor.discriminators &&\n        Constructor.schema &&\n        Constructor.schema.options &&\n        Constructor.schema.options.discriminatorKey) {\n      if (typeof obj[Constructor.schema.options.discriminatorKey] === 'string' &&\n          Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]]) {\n        Constructor = Constructor.discriminators[obj[Constructor.schema.options.discriminatorKey]];\n      } else {\n        const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, obj[Constructor.schema.options.discriminatorKey]);\n        if (constructorByValue) {\n          Constructor = constructorByValue;\n        }\n      }\n    }\n\n    return new Constructor(obj, this);\n  },\n\n  /*!\n   * ignore\n   */\n\n  notify(event) {\n    const _this = this;\n    return function notify(val, _arr) {\n      _arr = _arr || _this;\n      let i = _arr.length;\n      while (i--) {\n        if (_arr[i] == null) {\n          continue;\n        }\n        switch (event) {\n          // only swap for save event for now, we may change this to all event types later\n          case 'save':\n            val = _this[i];\n            break;\n          default:\n            // NO-OP\n            break;\n        }\n\n        if (utils.isMongooseArray(_arr[i])) {\n          notify(val, _arr[i]);\n        } else if (_arr[i]) {\n          _arr[i].emit(event, val);\n        }\n      }\n    };\n  },\n\n  set(i, val, skipModified) {\n    const arr = this.__array;\n    if (skipModified) {\n      arr[i] = val;\n      return this;\n    }\n    const value = methods._cast.call(this, val, i);\n    methods._markModified.call(this, i);\n    arr[i] = value;\n    return this;\n  },\n\n  _markModified(elem, embeddedPath) {\n    const parent = this[arrayParentSymbol];\n    let dirtyPath;\n\n    if (parent) {\n      dirtyPath = this[arrayPathSymbol];\n\n      if (arguments.length) {\n        if (embeddedPath != null) {\n          // an embedded doc bubbled up the change\n          const index = elem.__index;\n          dirtyPath = dirtyPath + '.' + index + '.' + embeddedPath;\n        } else {\n          // directly set an index\n          dirtyPath = dirtyPath + '.' + elem;\n        }\n      }\n\n      if (dirtyPath != null && dirtyPath.endsWith('.$')) {\n        return this;\n      }\n\n      parent.markModified(dirtyPath, arguments.length !== 0 ? elem : parent);\n    }\n\n    return this;\n  }\n};\n\nmodule.exports = methods;\n\n/*!\n * If this is a document array, each element may contain single\n * populated paths, so we need to modify the top-level document's\n * populated cache. See gh-8247, gh-8265.\n */\n\nfunction _updateParentPopulated(arr) {\n  const parent = arr[arrayParentSymbol];\n  if (!parent || parent.$__.populated == null) return;\n\n  const populatedPaths = Object.keys(parent.$__.populated).\n    filter(p => p.startsWith(arr[arrayPathSymbol] + '.'));\n\n  for (const path of populatedPaths) {\n    const remnant = path.slice((arr[arrayPathSymbol] + '.').length);\n    if (!Array.isArray(parent.$__.populated[path].value)) {\n      continue;\n    }\n\n    parent.$__.populated[path].value = arr.map(val => val.$populated(remnant));\n  }\n}"],"mappings":"AAAA;;AAEA,MAAMA,YAAY,GAAGC,OAAO,CAAC,qBAAD,CAA5B;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAC,mBAAD,CAAxB;;AACA,MAAME,YAAY,GAAGF,OAAO,CAAC,wBAAD,CAA5B;;AACA,MAAMG,uBAAuB,GAAGH,OAAO,CAAC,wDAAD,CAAvC;;AACA,MAAMI,uBAAuB,GAAGJ,OAAO,CAAC,kBAAD,CAAP,CAA4BI,uBAA5D;;AACA,MAAMC,KAAK,GAAGL,OAAO,CAAC,gBAAD,CAArB;;AACA,MAAMM,UAAU,GAAGN,OAAO,CAAC,6BAAD,CAA1B;;AAEA,MAAMO,iBAAiB,GAAGP,OAAO,CAAC,0BAAD,CAAP,CAAoCO,iBAA9D;;AACA,MAAMC,eAAe,GAAGR,OAAO,CAAC,0BAAD,CAAP,CAAoCQ,eAA5D;;AACA,MAAMC,iBAAiB,GAAGT,OAAO,CAAC,0BAAD,CAAP,CAAoCS,iBAA9D;;AACA,MAAMC,mBAAmB,GAAGV,OAAO,CAAC,0BAAD,CAAP,CAAoCU,mBAAhE;;AAEA,MAAMC,OAAO,GAAG;EACd;AACF;AACA;EAEEC,MAAM,GAAG;IACP,OAAO,KAAKC,QAAL,CAAcT,uBAAd,CAAP;EACD,CAPa;;EASd;AACF;AACA;EAEEU,cAAc,GAAG;IACf,OAAO,KAAKP,iBAAL,CAAP;EACD,CAfa;;EAiBd;AACF;AACA;AACA;AACA;AACA;AACA;EAEEQ,KAAK,CAACC,KAAD,EAAQC,KAAR,EAAe;IAClB,IAAI,KAAKR,iBAAL,KAA2B,IAA/B,EAAqC;MACnC,OAAOO,KAAP;IACD;;IACD,IAAIE,WAAW,GAAG,KAAKT,iBAAL,EAAwBU,iBAA1C;IACA,MAAMC,UAAU,GAAGF,WAAW,CAACG,wBAAZ,GACjBhB,KAAK,CAACiB,uBAAN,CAA8BN,KAA9B,CADiB,GAEjBA,KAAK,YAAYE,WAFnB;;IAGA,IAAIE,UAAU,IACV;IACCJ,KAAK,IAAIA,KAAK,CAACO,WAAf,IAA8BP,KAAK,CAACO,WAAN,CAAkBC,qBAAlB,KAA4CN,WAF/E,EAE6F;MAC3F,IAAI,EAAEF,KAAK,CAACN,mBAAD,CAAL,IAA8BM,KAAK,CAACS,aAAtC,CAAJ,EAA0D;QACxD;QACAT,KAAK,CAACN,mBAAD,CAAL,GAA6B,KAAKH,iBAAL,CAA7B;QACAS,KAAK,CAACS,aAAN,GAAsB,IAAtB;MACD;;MACDT,KAAK,CAACU,SAAN,CAAgBT,KAAhB;MACA,OAAOD,KAAP;IACD;;IAED,IAAIA,KAAK,KAAKW,SAAV,IAAuBX,KAAK,KAAK,IAArC,EAA2C;MACzC,OAAO,IAAP;IACD,CAtBiB,CAwBlB;IACA;IACA;;;IACA,IAAIY,MAAM,CAACC,QAAP,CAAgBb,KAAhB,KACAV,UAAU,CAACU,KAAD,EAAQ,UAAR,CADV,IACiC,CAACX,KAAK,CAACyB,QAAN,CAAed,KAAf,CADtC,EAC6D;MAC3DA,KAAK,GAAG;QAAEe,GAAG,EAAEf;MAAP,CAAR;IACD;;IAED,IAAIA,KAAK,IACLE,WAAW,CAACc,cADZ,IAEAd,WAAW,CAACe,MAFZ,IAGAf,WAAW,CAACe,MAAZ,CAAmBC,OAHnB,IAIAhB,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAJ/B,EAIiD;MAC/C,IAAI,OAAOnB,KAAK,CAACE,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAAZ,KAA8D,QAA9D,IACAjB,WAAW,CAACc,cAAZ,CAA2BhB,KAAK,CAACE,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAAhC,CADJ,EACoF;QAClFjB,WAAW,GAAGA,WAAW,CAACc,cAAZ,CAA2BhB,KAAK,CAACE,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAAhC,CAAd;MACD,CAHD,MAGO;QACL,MAAMC,kBAAkB,GAAGjC,uBAAuB,CAACe,WAAW,CAACc,cAAb,EAA6BhB,KAAK,CAACE,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAAlC,CAAlD;;QACA,IAAIC,kBAAJ,EAAwB;UACtBlB,WAAW,GAAGkB,kBAAd;QACD;MACF;IACF;;IAED,IAAIlB,WAAW,CAACG,wBAAhB,EAA0C;MACxC,OAAOH,WAAW,CAACmB,IAAZ,CAAiBrB,KAAjB,EAAwB,IAAxB,EAA8BW,SAA9B,EAAyCA,SAAzC,EAAoDV,KAApD,CAAP;IACD;;IACD,MAAMqB,GAAG,GAAG,IAAIpB,WAAJ,CAAgBF,KAAhB,EAAuB,IAAvB,EAA6BW,SAA7B,EAAwCA,SAAxC,EAAmDV,KAAnD,CAAZ;IACAqB,GAAG,CAACC,KAAJ,GAAY,IAAZ;IACA,OAAOD,GAAP;EACD,CA/Ea;;EAiFd;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEEE,EAAE,CAACA,EAAD,EAAK;IACL,IAAIC,MAAJ;IACA,IAAIC,GAAJ;;IACA,IAAIX,GAAJ;;IAEA,IAAI;MACFU,MAAM,GAAGvC,YAAY,CAACsC,EAAD,CAAZ,CAAiBG,QAAjB,EAAT;IACD,CAFD,CAEE,OAAOC,CAAP,EAAU;MACVH,MAAM,GAAG,IAAT;IACD;;IAED,KAAK,MAAMI,GAAX,IAAkB,IAAlB,EAAwB;MACtB,IAAI,CAACA,GAAL,EAAU;QACR;MACD;;MAEDd,GAAG,GAAGc,GAAG,CAACC,GAAJ,CAAQ,KAAR,CAAN;;MAEA,IAAIf,GAAG,KAAK,IAAR,IAAgB,OAAOA,GAAP,KAAe,WAAnC,EAAgD;QAC9C;MACD,CAFD,MAEO,IAAIA,GAAG,YAAY9B,QAAnB,EAA6B;QAClCyC,GAAG,KAAKA,GAAG,GAAGK,MAAM,CAACP,EAAD,CAAjB,CAAH;;QACA,IAAIE,GAAG,IAAIX,GAAG,CAACA,GAAf,EAAoB;UAClB,OAAOc,GAAP;QACD;MACF,CALM,MAKA,IAAI,CAACvC,UAAU,CAACkC,EAAD,EAAK,UAAL,CAAX,IAA+B,CAAClC,UAAU,CAACyB,GAAD,EAAM,UAAN,CAA9C,EAAiE;QACtE,IAAIS,EAAE,IAAIT,GAAN,IAAa1B,KAAK,CAAC2C,SAAN,CAAgBR,EAAhB,EAAoBT,GAApB,CAAjB,EAA2C;UACzC,OAAOc,GAAP;QACD;MACF,CAJM,MAIA,IAAIJ,MAAM,IAAIV,GAAd,EAAmB;QACxB,OAAOc,GAAP;MACD;IACF;;IAED,OAAO,IAAP;EACD,CAnIa;;EAqId;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEEhC,QAAQ,CAACqB,OAAD,EAAU;IAChB;IACA;IACA,OAAO,GAAGe,MAAH,CAAU,KAAKC,GAAL,CAAS,UAASC,GAAT,EAAc;MACtC,IAAIA,GAAG,IAAI,IAAX,EAAiB;QACf,OAAO,IAAP;MACD;;MACD,IAAI,OAAOA,GAAG,CAACtC,QAAX,KAAwB,UAA5B,EAAwC;QACtC,OAAOsC,GAAP;MACD;;MACD,OAAOA,GAAG,CAACtC,QAAJ,CAAaqB,OAAb,CAAP;IACD,CARgB,CAAV,CAAP;EASD,CA/Ja;;EAiKdkB,SAAS,GAAG;IACV,OAAO,KAAK7B,WAAL,CAAiB8B,SAAjB,CAA2BxC,QAA3B,CAAoCyC,KAApC,CAA0C,IAA1C,EAAgDC,SAAhD,CAAP;EACD,CAnKa;;EAqKd;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EAEEC,IAAI,GAAG;IACL,MAAMlB,GAAG,GAAGvC,YAAY,CAACyD,IAAb,CAAkBF,KAAlB,CAAwB,IAAxB,EAA8BC,SAA9B,CAAZ;;IAEAE,sBAAsB,CAAC,IAAD,CAAtB;;IAEA,OAAOnB,GAAP;EACD,CApLa;;EAsLd;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EAEEoB,IAAI,GAAG;IACL,MAAMpB,GAAG,GAAGvC,YAAY,CAAC2D,IAAb,CAAkBJ,KAAlB,CAAwB,IAAxB,EAA8BC,SAA9B,CAAZ;;IAEAE,sBAAsB,CAAC,IAAD,CAAtB;;IAEA,OAAOnB,GAAP;EACD,CArMa;;EAuMd;AACF;AACA;EAEEqB,KAAK,GAAG;IACN,MAAMrB,GAAG,GAAGvC,YAAY,CAAC4D,KAAb,CAAmBL,KAAnB,CAAyB,IAAzB,EAA+BC,SAA/B,CAAZ;;IAEAE,sBAAsB,CAAC,IAAD,CAAtB;;IAEA,OAAOnB,GAAP;EACD,CAjNa;;EAmNd;AACF;AACA;EAEEsB,MAAM,GAAG;IACP,MAAMtB,GAAG,GAAGvC,YAAY,CAAC6D,MAAb,CAAoBN,KAApB,CAA0B,IAA1B,EAAgCC,SAAhC,CAAZ;;IAEAE,sBAAsB,CAAC,IAAD,CAAtB;;IAEA,OAAOnB,GAAP;EACD,CA7Na;;EA+Nd;AACF;AACA;AACA;AACA;AACA;AACA;EAEEuB,OAAO,GAAG;IACR,OAAO,KAAKhD,QAAL,EAAP;EACD,CAzOa;;EA2Od;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EAEEiD,MAAM,CAACC,GAAD,EAAM;IACV,IAAI7C,WAAW,GAAG,KAAKT,iBAAL,EAAwBU,iBAA1C;;IACA,IAAI4C,GAAG,IACH7C,WAAW,CAACc,cADZ,IAEAd,WAAW,CAACe,MAFZ,IAGAf,WAAW,CAACe,MAAZ,CAAmBC,OAHnB,IAIAhB,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAJ/B,EAIiD;MAC/C,IAAI,OAAO4B,GAAG,CAAC7C,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAAV,KAA4D,QAA5D,IACAjB,WAAW,CAACc,cAAZ,CAA2B+B,GAAG,CAAC7C,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAA9B,CADJ,EACkF;QAChFjB,WAAW,GAAGA,WAAW,CAACc,cAAZ,CAA2B+B,GAAG,CAAC7C,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAA9B,CAAd;MACD,CAHD,MAGO;QACL,MAAMC,kBAAkB,GAAGjC,uBAAuB,CAACe,WAAW,CAACc,cAAb,EAA6B+B,GAAG,CAAC7C,WAAW,CAACe,MAAZ,CAAmBC,OAAnB,CAA2BC,gBAA5B,CAAhC,CAAlD;;QACA,IAAIC,kBAAJ,EAAwB;UACtBlB,WAAW,GAAGkB,kBAAd;QACD;MACF;IACF;;IAED,OAAO,IAAIlB,WAAJ,CAAgB6C,GAAhB,EAAqB,IAArB,CAAP;EACD,CAzQa;;EA2Qd;AACF;AACA;EAEEC,MAAM,CAACC,KAAD,EAAQ;IACZ,MAAMC,KAAK,GAAG,IAAd;;IACA,OAAO,SAASF,MAAT,CAAgBnB,GAAhB,EAAqBsB,IAArB,EAA2B;MAChCA,IAAI,GAAGA,IAAI,IAAID,KAAf;MACA,IAAIE,CAAC,GAAGD,IAAI,CAACE,MAAb;;MACA,OAAOD,CAAC,EAAR,EAAY;QACV,IAAID,IAAI,CAACC,CAAD,CAAJ,IAAW,IAAf,EAAqB;UACnB;QACD;;QACD,QAAQH,KAAR;UACE;UACA,KAAK,MAAL;YACEpB,GAAG,GAAGqB,KAAK,CAACE,CAAD,CAAX;YACA;;UACF;YACE;YACA;QAPJ;;QAUA,IAAI/D,KAAK,CAACiE,eAAN,CAAsBH,IAAI,CAACC,CAAD,CAA1B,CAAJ,EAAoC;UAClCJ,MAAM,CAACnB,GAAD,EAAMsB,IAAI,CAACC,CAAD,CAAV,CAAN;QACD,CAFD,MAEO,IAAID,IAAI,CAACC,CAAD,CAAR,EAAa;UAClBD,IAAI,CAACC,CAAD,CAAJ,CAAQG,IAAR,CAAaN,KAAb,EAAoBpB,GAApB;QACD;MACF;IACF,CAvBD;EAwBD,CAzSa;;EA2Sd2B,GAAG,CAACJ,CAAD,EAAIvB,GAAJ,EAAS4B,YAAT,EAAuB;IACxB,MAAMC,GAAG,GAAG,KAAKC,OAAjB;;IACA,IAAIF,YAAJ,EAAkB;MAChBC,GAAG,CAACN,CAAD,CAAH,GAASvB,GAAT;MACA,OAAO,IAAP;IACD;;IACD,MAAM7B,KAAK,GAAGL,OAAO,CAACI,KAAR,CAAc6D,IAAd,CAAmB,IAAnB,EAAyB/B,GAAzB,EAA8BuB,CAA9B,CAAd;;IACAzD,OAAO,CAACkE,aAAR,CAAsBD,IAAtB,CAA2B,IAA3B,EAAiCR,CAAjC;;IACAM,GAAG,CAACN,CAAD,CAAH,GAASpD,KAAT;IACA,OAAO,IAAP;EACD,CArTa;;EAuTd6D,aAAa,CAACC,IAAD,EAAOC,YAAP,EAAqB;IAChC,MAAMC,MAAM,GAAG,KAAKzE,iBAAL,CAAf;IACA,IAAI0E,SAAJ;;IAEA,IAAID,MAAJ,EAAY;MACVC,SAAS,GAAG,KAAKzE,eAAL,CAAZ;;MAEA,IAAI+C,SAAS,CAACc,MAAd,EAAsB;QACpB,IAAIU,YAAY,IAAI,IAApB,EAA0B;UACxB;UACA,MAAM9D,KAAK,GAAG6D,IAAI,CAACI,OAAnB;UACAD,SAAS,GAAGA,SAAS,GAAG,GAAZ,GAAkBhE,KAAlB,GAA0B,GAA1B,GAAgC8D,YAA5C;QACD,CAJD,MAIO;UACL;UACAE,SAAS,GAAGA,SAAS,GAAG,GAAZ,GAAkBH,IAA9B;QACD;MACF;;MAED,IAAIG,SAAS,IAAI,IAAb,IAAqBA,SAAS,CAACE,QAAV,CAAmB,IAAnB,CAAzB,EAAmD;QACjD,OAAO,IAAP;MACD;;MAEDH,MAAM,CAACI,YAAP,CAAoBH,SAApB,EAA+B1B,SAAS,CAACc,MAAV,KAAqB,CAArB,GAAyBS,IAAzB,GAAgCE,MAA/D;IACD;;IAED,OAAO,IAAP;EACD;;AAjVa,CAAhB;AAoVAK,MAAM,CAACC,OAAP,GAAiB3E,OAAjB;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS8C,sBAAT,CAAgCiB,GAAhC,EAAqC;EACnC,MAAMM,MAAM,GAAGN,GAAG,CAACnE,iBAAD,CAAlB;EACA,IAAI,CAACyE,MAAD,IAAWA,MAAM,CAACO,GAAP,CAAWC,SAAX,IAAwB,IAAvC,EAA6C;EAE7C,MAAMC,cAAc,GAAGC,MAAM,CAACC,IAAP,CAAYX,MAAM,CAACO,GAAP,CAAWC,SAAvB,EACrBI,MADqB,CACdC,CAAC,IAAIA,CAAC,CAACC,UAAF,CAAapB,GAAG,CAAClE,eAAD,CAAH,GAAuB,GAApC,CADS,CAAvB;;EAGA,KAAK,MAAMuF,IAAX,IAAmBN,cAAnB,EAAmC;IACjC,MAAMO,OAAO,GAAGD,IAAI,CAACE,KAAL,CAAW,CAACvB,GAAG,CAAClE,eAAD,CAAH,GAAuB,GAAxB,EAA6B6D,MAAxC,CAAhB;;IACA,IAAI,CAAC6B,KAAK,CAACC,OAAN,CAAcnB,MAAM,CAACO,GAAP,CAAWC,SAAX,CAAqBO,IAArB,EAA2B/E,KAAzC,CAAL,EAAsD;MACpD;IACD;;IAEDgE,MAAM,CAACO,GAAP,CAAWC,SAAX,CAAqBO,IAArB,EAA2B/E,KAA3B,GAAmC0D,GAAG,CAACxB,GAAJ,CAAQL,GAAG,IAAIA,GAAG,CAACuD,UAAJ,CAAeJ,OAAf,CAAf,CAAnC;EACD;AACF"},"metadata":{},"sourceType":"script"}