{"ast":null,"code":"'use strict';\n\nconst each = require('../helpers/each');\n/*!\n * ignore\n */\n\n\nmodule.exports = function (schema) {\n  const unshift = true;\n  schema.s.hooks.pre('save', false, function (next) {\n    if (this.$isSubdocument) {\n      next();\n      return;\n    }\n\n    const _this = this;\n\n    const subdocs = this.$getAllSubdocs();\n\n    if (!subdocs.length) {\n      next();\n      return;\n    }\n\n    each(subdocs, function (subdoc, cb) {\n      subdoc.$__schema.s.hooks.execPre('save', subdoc, function (err) {\n        cb(err);\n      });\n    }, function (error) {\n      if (error) {\n        return _this.$__schema.s.hooks.execPost('save:error', _this, [_this], {\n          error: error\n        }, function (error) {\n          next(error);\n        });\n      }\n\n      next();\n    });\n  }, null, unshift);\n  schema.s.hooks.post('save', function (doc, next) {\n    if (this.$isSubdocument) {\n      next();\n      return;\n    }\n\n    const _this = this;\n\n    const subdocs = this.$getAllSubdocs();\n\n    if (!subdocs.length) {\n      next();\n      return;\n    }\n\n    each(subdocs, function (subdoc, cb) {\n      subdoc.$__schema.s.hooks.execPost('save', subdoc, [subdoc], function (err) {\n        cb(err);\n      });\n    }, function (error) {\n      if (error) {\n        return _this.$__schema.s.hooks.execPost('save:error', _this, [_this], {\n          error: error\n        }, function (error) {\n          next(error);\n        });\n      }\n\n      next();\n    });\n  }, null, unshift);\n};","map":{"version":3,"names":["each","require","module","exports","schema","unshift","s","hooks","pre","next","$isSubdocument","_this","subdocs","$getAllSubdocs","length","subdoc","cb","$__schema","execPre","err","error","execPost","post","doc"],"sources":["B:/web_project_react/web_car_react/node_modules/mongoose/lib/plugins/saveSubdocs.js"],"sourcesContent":["'use strict';\n\nconst each = require('../helpers/each');\n\n/*!\n * ignore\n */\n\nmodule.exports = function(schema) {\n  const unshift = true;\n  schema.s.hooks.pre('save', false, function(next) {\n    if (this.$isSubdocument) {\n      next();\n      return;\n    }\n\n    const _this = this;\n    const subdocs = this.$getAllSubdocs();\n\n    if (!subdocs.length) {\n      next();\n      return;\n    }\n\n    each(subdocs, function(subdoc, cb) {\n      subdoc.$__schema.s.hooks.execPre('save', subdoc, function(err) {\n        cb(err);\n      });\n    }, function(error) {\n      if (error) {\n        return _this.$__schema.s.hooks.execPost('save:error', _this, [_this], { error: error }, function(error) {\n          next(error);\n        });\n      }\n      next();\n    });\n  }, null, unshift);\n\n  schema.s.hooks.post('save', function(doc, next) {\n    if (this.$isSubdocument) {\n      next();\n      return;\n    }\n\n    const _this = this;\n    const subdocs = this.$getAllSubdocs();\n\n    if (!subdocs.length) {\n      next();\n      return;\n    }\n\n    each(subdocs, function(subdoc, cb) {\n      subdoc.$__schema.s.hooks.execPost('save', subdoc, [subdoc], function(err) {\n        cb(err);\n      });\n    }, function(error) {\n      if (error) {\n        return _this.$__schema.s.hooks.execPost('save:error', _this, [_this], { error: error }, function(error) {\n          next(error);\n        });\n      }\n      next();\n    });\n  }, null, unshift);\n};\n"],"mappings":"AAAA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,iBAAD,CAApB;AAEA;AACA;AACA;;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAASC,MAAT,EAAiB;EAChC,MAAMC,OAAO,GAAG,IAAhB;EACAD,MAAM,CAACE,CAAP,CAASC,KAAT,CAAeC,GAAf,CAAmB,MAAnB,EAA2B,KAA3B,EAAkC,UAASC,IAAT,EAAe;IAC/C,IAAI,KAAKC,cAAT,EAAyB;MACvBD,IAAI;MACJ;IACD;;IAED,MAAME,KAAK,GAAG,IAAd;;IACA,MAAMC,OAAO,GAAG,KAAKC,cAAL,EAAhB;;IAEA,IAAI,CAACD,OAAO,CAACE,MAAb,EAAqB;MACnBL,IAAI;MACJ;IACD;;IAEDT,IAAI,CAACY,OAAD,EAAU,UAASG,MAAT,EAAiBC,EAAjB,EAAqB;MACjCD,MAAM,CAACE,SAAP,CAAiBX,CAAjB,CAAmBC,KAAnB,CAAyBW,OAAzB,CAAiC,MAAjC,EAAyCH,MAAzC,EAAiD,UAASI,GAAT,EAAc;QAC7DH,EAAE,CAACG,GAAD,CAAF;MACD,CAFD;IAGD,CAJG,EAID,UAASC,KAAT,EAAgB;MACjB,IAAIA,KAAJ,EAAW;QACT,OAAOT,KAAK,CAACM,SAAN,CAAgBX,CAAhB,CAAkBC,KAAlB,CAAwBc,QAAxB,CAAiC,YAAjC,EAA+CV,KAA/C,EAAsD,CAACA,KAAD,CAAtD,EAA+D;UAAES,KAAK,EAAEA;QAAT,CAA/D,EAAiF,UAASA,KAAT,EAAgB;UACtGX,IAAI,CAACW,KAAD,CAAJ;QACD,CAFM,CAAP;MAGD;;MACDX,IAAI;IACL,CAXG,CAAJ;EAYD,CA1BD,EA0BG,IA1BH,EA0BSJ,OA1BT;EA4BAD,MAAM,CAACE,CAAP,CAASC,KAAT,CAAee,IAAf,CAAoB,MAApB,EAA4B,UAASC,GAAT,EAAcd,IAAd,EAAoB;IAC9C,IAAI,KAAKC,cAAT,EAAyB;MACvBD,IAAI;MACJ;IACD;;IAED,MAAME,KAAK,GAAG,IAAd;;IACA,MAAMC,OAAO,GAAG,KAAKC,cAAL,EAAhB;;IAEA,IAAI,CAACD,OAAO,CAACE,MAAb,EAAqB;MACnBL,IAAI;MACJ;IACD;;IAEDT,IAAI,CAACY,OAAD,EAAU,UAASG,MAAT,EAAiBC,EAAjB,EAAqB;MACjCD,MAAM,CAACE,SAAP,CAAiBX,CAAjB,CAAmBC,KAAnB,CAAyBc,QAAzB,CAAkC,MAAlC,EAA0CN,MAA1C,EAAkD,CAACA,MAAD,CAAlD,EAA4D,UAASI,GAAT,EAAc;QACxEH,EAAE,CAACG,GAAD,CAAF;MACD,CAFD;IAGD,CAJG,EAID,UAASC,KAAT,EAAgB;MACjB,IAAIA,KAAJ,EAAW;QACT,OAAOT,KAAK,CAACM,SAAN,CAAgBX,CAAhB,CAAkBC,KAAlB,CAAwBc,QAAxB,CAAiC,YAAjC,EAA+CV,KAA/C,EAAsD,CAACA,KAAD,CAAtD,EAA+D;UAAES,KAAK,EAAEA;QAAT,CAA/D,EAAiF,UAASA,KAAT,EAAgB;UACtGX,IAAI,CAACW,KAAD,CAAJ;QACD,CAFM,CAAP;MAGD;;MACDX,IAAI;IACL,CAXG,CAAJ;EAYD,CA1BD,EA0BG,IA1BH,EA0BSJ,OA1BT;AA2BD,CAzDD"},"metadata":{},"sourceType":"script"}