{"ast":null,"code":"import _asyncToGenerator from\"B:/web_project_react/web_car_react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"B:/web_project_react/web_car_react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"B:\\\\web_project_react\\\\web_car_react\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import'./login.css';import{useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),login=_useState2[0],setLogin=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),passwordValid=_useState6[0],setPasswordValid=_useState6[1];var onChangeLogin=function onChangeLogin(event){setLogin(event.target.value);};var onChangePassword=function onChangePassword(event){setPassword(event.target.value);};useEffect(function(){setPasswordValid(false);},[password]);var sentRequest=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,res,lol;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(password.length>=5)){_context.next=20;break;}data={\"login\":login,\"password\":password};console.log(data);_context.next=5;return fetch(\"http://127.0.0.1:5000/api/v1/user/login\",{method:'POST',headers:{'Content-type':'application/json','Accept':'application/json'},body:JSON.stringify(data)});case 5:res=_context.sent;lol='';if(!res.ok){_context.next=16;break;}_context.next=10;return res.json();case 10:lol=_context.sent;localStorage.setItem('token',lol);localStorage.setItem('login',login);window.location.reload();_context.next=19;break;case 16:localStorage.setItem('token',null);localStorage.setItem('login',null);alert(\"something is wrong\");case 19:console.log(lol);case 20:case\"end\":return _context.stop();}}},_callee);}));return function sentRequest(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"main\",{className:\"main_login\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main_head_login\",children:/*#__PURE__*/_jsx(\"div\",{className:\"main_section_login\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome back\"}),/*#__PURE__*/_jsx(\"input\",{id:\"login\",type:\"text\",placeholder:\"Username\",onChange:onChangeLogin}),/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",placeholder:\"Password\",onChange:onChangePassword}),passwordValid&&/*#__PURE__*/_jsx(\"p\",{children:\"Please enter your password > 4\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",id:\"log_button\",onClick:sentRequest,children:\"Login\"})]})})})});};export default Login;","map":{"version":3,"names":["useState","useEffect","Login","props","login","setLogin","password","setPassword","passwordValid","setPasswordValid","onChangeLogin","event","target","value","onChangePassword","sentRequest","length","data","console","log","fetch","method","headers","body","JSON","stringify","res","lol","ok","json","localStorage","setItem","window","location","reload","alert"],"sources":["B:/web_project_react/web_car_react/src/component/login/login.js"],"sourcesContent":["import './login.css';\r\nimport { useState, useEffect } from 'react';\r\n\r\nconst Login = (props) => {\r\n    const [login, setLogin] = useState();\r\n    const [password, setPassword] = useState();\r\n    const [passwordValid, setPasswordValid] = useState(false);\r\n\r\n    const onChangeLogin = (event) => {\r\n        setLogin(event.target.value);\r\n    }\r\n\r\n    const onChangePassword = (event) => {\r\n        setPassword(event.target.value);\r\n    }\r\n    \r\n    useEffect(() => {\r\n        setPasswordValid(false);\r\n    }, [password])\r\n\r\n    const sentRequest = async () => {\r\n       if(password.length >= 5){\r\n            const data = { \"login\":login, \"password\":password};\r\n            console.log(data)\r\n            const res = await fetch(\"http://127.0.0.1:5000/api/v1/user/login\", \r\n            {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-type': 'application/json',\r\n                'Accept': 'application/json'\r\n            },\r\n            body:JSON.stringify(data)});\r\n            let lol = '';\r\n            if(res.ok){\r\n                lol = await res.json();\r\n                localStorage.setItem('token', lol);\r\n                localStorage.setItem('login', login);\r\n                window.location.reload();\r\n            }else{\r\n                localStorage.setItem('token', null);\r\n                localStorage.setItem('login', null);\r\n                alert(\"something is wrong\")\r\n            }  \r\n            \r\n            console.log(lol);\r\n        }\r\n\r\n    }\r\n    return (\r\n        <main className=\"main_login\">\r\n            <div className=\"main_head_login\">\r\n                <div className=\"main_section_login\">\r\n                    <div className=\"login\">\r\n                    <h2>Welcome back</h2>\r\n                    <input id = \"login\" type=\"text\" placeholder=\"Username\" onChange={onChangeLogin}/>\r\n                    <input id = \"password\" type=\"password\" placeholder=\"Password\" onChange={onChangePassword}/>\r\n                    {passwordValid && <p>Please enter your password &gt; 4</p>}\r\n                    <button type='submit' id = \"log_button\" onClick={sentRequest}>Login</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </main>\r\n    )\r\n}\r\n\r\nexport default Login;"],"mappings":"kXAAA,MAAO,aAAP,CACA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,C,wFAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,KAAD,CAAW,CACrB,cAA0BH,QAAQ,EAAlC,wCAAOI,KAAP,eAAcC,QAAd,eACA,eAAgCL,QAAQ,EAAxC,yCAAOM,QAAP,eAAiBC,WAAjB,eACA,eAA0CP,QAAQ,CAAC,KAAD,CAAlD,yCAAOQ,aAAP,eAAsBC,gBAAtB,eAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,KAAD,CAAW,CAC7BN,QAAQ,CAACM,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAR,CACH,CAFD,CAIA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACH,KAAD,CAAW,CAChCJ,WAAW,CAACI,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAX,CACH,CAFD,CAIAZ,SAAS,CAAC,UAAM,CACZQ,gBAAgB,CAAC,KAAD,CAAhB,CACH,CAFQ,CAEN,CAACH,QAAD,CAFM,CAAT,CAIA,GAAMS,CAAAA,WAAW,0FAAG,yJACdT,QAAQ,CAACU,MAAT,EAAmB,CADL,2BAENC,IAFM,CAEC,CAAE,QAAQb,KAAV,CAAiB,WAAWE,QAA5B,CAFD,CAGZY,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAHY,sBAIMG,CAAAA,KAAK,CAAC,yCAAD,CACvB,CACAC,MAAM,CAAE,MADR,CAEAC,OAAO,CAAE,CACL,eAAgB,kBADX,CAEL,SAAU,kBAFL,CAFT,CAMAC,IAAI,CAACC,IAAI,CAACC,SAAL,CAAeR,IAAf,CANL,CADuB,CAJX,QAINS,GAJM,eAYRC,GAZQ,CAYF,EAZE,KAaTD,GAAG,CAACE,EAbK,iDAcIF,CAAAA,GAAG,CAACG,IAAJ,EAdJ,SAcRF,GAdQ,eAeRG,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BJ,GAA9B,EACAG,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B3B,KAA9B,EACA4B,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAjBQ,+BAmBRJ,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B,IAA9B,EACAD,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8B,IAA9B,EACAI,KAAK,CAAC,oBAAD,CAAL,CArBQ,QAwBZjB,OAAO,CAACC,GAAR,CAAYQ,GAAZ,EAxBY,uDAAH,kBAAXZ,CAAAA,WAAW,0CAAjB,CA4BA,mBACI,aAAM,SAAS,CAAC,YAAhB,uBACI,YAAK,SAAS,CAAC,iBAAf,uBACI,YAAK,SAAS,CAAC,oBAAf,uBACI,aAAK,SAAS,CAAC,OAAf,wBACA,oCADA,cAEA,cAAO,EAAE,CAAG,OAAZ,CAAoB,IAAI,CAAC,MAAzB,CAAgC,WAAW,CAAC,UAA5C,CAAuD,QAAQ,CAAEL,aAAjE,EAFA,cAGA,cAAO,EAAE,CAAG,UAAZ,CAAuB,IAAI,CAAC,UAA5B,CAAuC,WAAW,CAAC,UAAnD,CAA8D,QAAQ,CAAEI,gBAAxE,EAHA,CAICN,aAAa,eAAI,qDAJlB,cAKA,eAAQ,IAAI,CAAC,QAAb,CAAsB,EAAE,CAAG,YAA3B,CAAwC,OAAO,CAAEO,WAAjD,mBALA,GADJ,EADJ,EADJ,EADJ,CAeH,CA5DD,CA8DA,cAAeb,CAAAA,KAAf"},"metadata":{},"sourceType":"module"}