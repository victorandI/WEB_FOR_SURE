{"ast":null,"code":"'use strict';\n\nconst hasIncludedChildren = require('./hasIncludedChildren');\n\nconst isExclusive = require('./isExclusive');\n\nconst isInclusive = require('./isInclusive');\n\nconst isPOJO = require('../../utils').isPOJO;\n\nmodule.exports = function applyProjection(doc, projection, _hasIncludedChildren) {\n  if (projection == null) {\n    return doc;\n  }\n\n  if (doc == null) {\n    return doc;\n  }\n\n  let exclude = null;\n\n  if (isInclusive(projection)) {\n    exclude = false;\n  } else if (isExclusive(projection)) {\n    exclude = true;\n  }\n\n  if (exclude == null) {\n    return doc;\n  } else if (exclude) {\n    _hasIncludedChildren = _hasIncludedChildren || hasIncludedChildren(projection);\n    return applyExclusiveProjection(doc, projection, _hasIncludedChildren);\n  } else {\n    _hasIncludedChildren = _hasIncludedChildren || hasIncludedChildren(projection);\n    return applyInclusiveProjection(doc, projection, _hasIncludedChildren);\n  }\n};\n\nfunction applyExclusiveProjection(doc, projection, hasIncludedChildren, projectionLimb, prefix) {\n  if (doc == null || typeof doc !== 'object') {\n    return doc;\n  }\n\n  const ret = { ...doc\n  };\n  projectionLimb = prefix ? projectionLimb || {} : projection;\n\n  for (const key of Object.keys(ret)) {\n    const fullPath = prefix ? prefix + '.' + key : key;\n\n    if (projection.hasOwnProperty(fullPath) || projectionLimb.hasOwnProperty(key)) {\n      if (isPOJO(projection[fullPath]) || isPOJO(projectionLimb[key])) {\n        ret[key] = applyExclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n      } else {\n        delete ret[key];\n      }\n    } else if (hasIncludedChildren[fullPath]) {\n      ret[key] = applyExclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n    }\n  }\n\n  return ret;\n}\n\nfunction applyInclusiveProjection(doc, projection, hasIncludedChildren, projectionLimb, prefix) {\n  if (doc == null || typeof doc !== 'object') {\n    return doc;\n  }\n\n  const ret = { ...doc\n  };\n  projectionLimb = prefix ? projectionLimb || {} : projection;\n\n  for (const key of Object.keys(ret)) {\n    const fullPath = prefix ? prefix + '.' + key : key;\n\n    if (projection.hasOwnProperty(fullPath) || projectionLimb.hasOwnProperty(key)) {\n      if (isPOJO(projection[fullPath]) || isPOJO(projectionLimb[key])) {\n        ret[key] = applyInclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n      }\n\n      continue;\n    } else if (hasIncludedChildren[fullPath]) {\n      ret[key] = applyInclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n    } else {\n      delete ret[key];\n    }\n  }\n\n  return ret;\n}","map":{"version":3,"names":["hasIncludedChildren","require","isExclusive","isInclusive","isPOJO","module","exports","applyProjection","doc","projection","_hasIncludedChildren","exclude","applyExclusiveProjection","applyInclusiveProjection","projectionLimb","prefix","ret","key","Object","keys","fullPath","hasOwnProperty"],"sources":["B:/web_project_react/web_car_react/node_modules/mongoose/lib/helpers/projection/applyProjection.js"],"sourcesContent":["'use strict';\n\nconst hasIncludedChildren = require('./hasIncludedChildren');\nconst isExclusive = require('./isExclusive');\nconst isInclusive = require('./isInclusive');\nconst isPOJO = require('../../utils').isPOJO;\n\nmodule.exports = function applyProjection(doc, projection, _hasIncludedChildren) {\n  if (projection == null) {\n    return doc;\n  }\n  if (doc == null) {\n    return doc;\n  }\n\n  let exclude = null;\n  if (isInclusive(projection)) {\n    exclude = false;\n  } else if (isExclusive(projection)) {\n    exclude = true;\n  }\n\n  if (exclude == null) {\n    return doc;\n  } else if (exclude) {\n    _hasIncludedChildren = _hasIncludedChildren || hasIncludedChildren(projection);\n    return applyExclusiveProjection(doc, projection, _hasIncludedChildren);\n  } else {\n    _hasIncludedChildren = _hasIncludedChildren || hasIncludedChildren(projection);\n    return applyInclusiveProjection(doc, projection, _hasIncludedChildren);\n  }\n};\n\nfunction applyExclusiveProjection(doc, projection, hasIncludedChildren, projectionLimb, prefix) {\n  if (doc == null || typeof doc !== 'object') {\n    return doc;\n  }\n  const ret = { ...doc };\n  projectionLimb = prefix ? (projectionLimb || {}) : projection;\n\n  for (const key of Object.keys(ret)) {\n    const fullPath = prefix ? prefix + '.' + key : key;\n    if (projection.hasOwnProperty(fullPath) || projectionLimb.hasOwnProperty(key)) {\n      if (isPOJO(projection[fullPath]) || isPOJO(projectionLimb[key])) {\n        ret[key] = applyExclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n      } else {\n        delete ret[key];\n      }\n    } else if (hasIncludedChildren[fullPath]) {\n      ret[key] = applyExclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n    }\n  }\n  return ret;\n}\n\nfunction applyInclusiveProjection(doc, projection, hasIncludedChildren, projectionLimb, prefix) {\n  if (doc == null || typeof doc !== 'object') {\n    return doc;\n  }\n  const ret = { ...doc };\n  projectionLimb = prefix ? (projectionLimb || {}) : projection;\n\n  for (const key of Object.keys(ret)) {\n    const fullPath = prefix ? prefix + '.' + key : key;\n    if (projection.hasOwnProperty(fullPath) || projectionLimb.hasOwnProperty(key)) {\n      if (isPOJO(projection[fullPath]) || isPOJO(projectionLimb[key])) {\n        ret[key] = applyInclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n      }\n      continue;\n    } else if (hasIncludedChildren[fullPath]) {\n      ret[key] = applyInclusiveProjection(ret[key], projection, hasIncludedChildren, projectionLimb[key], fullPath);\n    } else {\n      delete ret[key];\n    }\n  }\n  return ret;\n}"],"mappings":"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"},"metadata":{},"sourceType":"script"}